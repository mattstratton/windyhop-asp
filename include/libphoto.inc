<%Dim objImageDim intImageHeightDim intImageWidthDim intNewHeightDim intNewWidth'On Error Resume NextFunction GetPhotoID(strName)	'Returns the PhotoID given the file name	Dim localSQL	Dim objLocalDB	Dim objLocalRS	Set objLocalDB = Server.CreateObject("ADODB.Connection")	objLocalDB.Open DATABASE	localSQL = "Select PhotoID from Photo WHERE FileName = '" & strName & "'"	Response.Write(localSQL)	Set objLocalRS = objlocalDB.Execute(localSQL)		GetPhotoID = objLocalRS("PhotoID")	objLocalRS.Close	objLocalDB.CloseEnd Function	'GetPhotoIDSub UpdateData(localPhotoId,strFileName,strThumbNailName,strName,strCaption,strApproved,lngUserID,intCategoryID)		Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE	Set objRS = Server.CreateObject("ADODB.Recordset")	If localPhotoID = 0 Then			objRS.open "photo", objDB, adOpenKeyset, adLockOptimistic			objRS.AddNew			objRS("UpdateDate") = Date & " " & Time			objRS("CreationDate") = Date & " " & Time			objRS("Filename") = UNAPPROVEDPATH & strFileName			objRS("ThumbNailName") = UNAPPROVEDPATH & strThumbNailName	Else			objRS.open "select * from Photo where PhotoID = " & localPhotoID, _			objDB, adOpenKeyset, adLockOptimistic	End If	'objRS("UpdateDate") = Date & " " & Time	objRS("name") = strName	objRS("Blurb") = strCaption	'objRS("Creationdate") = datCreationdate	'objRS("Updatedate") = datUpdatedate	objRS("Userid") = lngUserid	objRS("Approved") = strApproved	If intCategoryID <> 0 Then		CreateLink intCategoryID,localPhotoID,PHOTOLINK	End If	objRS.Update	objRS.Close	objDB.CloseEnd Sub	'UpdateDataFunction GetImageHeight(strFilePath)	Set objImage = Server.CreateObject("AspImage.Image")	objImage.LoadImage(Server.MapPath(strFilePath))	GetImageHeight = objImage.MaxY	Set objImage = NothingEnd FunctionFunction GetImageWidth(strFilePath)	Set objImage = Server.CreateObject("AspImage.Image")	objImage.LoadImage(Server.MapPath(strFilePath))	GetImageWidth = objImage.MaxX	Set objImage = NothingEnd FunctionSub CreateThumb(strImageName,strThumbName)	'*** creat thumbnail image	Set objImage = Server.CreateObject("AspImage.Image")	objImage.LoadImage(Server.MapPath(UNAPPROVEDPATH & strImageName))	intImageHeight = objImage.MaxY	intImageWidth = objImage.MaxX	'*** calculate aspect ratio based on MINPIXELS	Response.Write("I think the image path is: " & Server.MapPath(UNAPPROVEDPATH & strImageName) & "<br>")	Response.Write("Image Height is: " & intImageHeight)	Response.Write("<br>")	Response.Write("Image Width is: " & intImageWidth)	Response.Write("<br>")	If intImageHeight > intImageWidth Then		intNewHeight = Cint(intImageHeight*MINPIXELS/intImageWidth)		intNewWidth = MINPIXELS	Else		intNewWidth = Cint(intImageWidth*MINPIXELS/intImageHeight)		intNewHeight = MINPIXELS	End If	objImage.FileName = Server.MapPath(UNAPPROVEDPATH & strThumbName)	objImage.ImageFormat = 1	objImage.JPEGQuality = 70	objImage.Resize intNewWidth,intNewHeight	objImage.SaveImage	Response.Write("<br>")	Response.Write(objImage.Error)	Response.Write("<br>")	Set objImage = NothingEnd Sub	'CreateThumbSub FixKitty(strImageName)	' Max width is 640	Set objImage = Server.CreateObject("AspImage.Image")	objImage.LoadImage(Server.MapPath(UNAPPROVEDPATH & strImageName))	intImageHeight = objImage.MaxY	intImageWidth = objImage.MaxX	If intImageWidth > 640 Then		intNewHeight = Cint(intImageHeight*640/intImageWidth)		intNewWidth = 640		objImage.FileName = Server.MapPath(UNAPPROVEDPATH & strImageName)		objImage.ImageFormat = 1		objImage.JPEGQuality = 70		objImage.Resize intNewWidth,intNewHeight		objImage.SaveImage		Set objImage = Nothing	End IfEnd Sub	'FixKitty%>