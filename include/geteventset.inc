<%' GetEventSet( 	lngBandID,'				lngVenueID,'				lngInstructorID,'				strLesson, '				strShowDJ,'				strOther, '				strWorkshop,'				datBeginDate, '				datEndDate,'				strApproved,' 				lngEventID)''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub GetOptions()		If strLesson = YES Then		'Response.Write("<br>Lesson = YES<br>")		strEventTypeList = strEventTypeList & " '"&LESSON&"',"	End If		If strWorkshop = YES Then		'Response.Write("<br>ws = YES<br>")		strEventTypeList = strEventTypeList & " '"&WORKSHOP&"',"	End If		If strOther = YES Then		strEventTypeList = strEventTypeList & " '"&OTHER&"',"	End If	If strShowDJ = YES Then		'Response.Write("<br>Show = YES<br>")		strEventTypeList = strEventTypeList & " '"&SHOWDJ&"',"	End If		End Sub 'GetOptions''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildSQL()			Dim Other		tempSQL = " SELECT  Event.Name AS EventName, " & _ 			 "          Event.EventID,  " & _			 "          Event.Date,  " & _			 "          Event.VenueID,  " & _			 "          Event.BandID,  " & _ 			 "          Event.InstructorID,  " & _			 "          Event.LessonTime,  " & _			 "          Event.ShowTime,  " & _			 "          Event.EndTime,  " & _			 "          Event.Price,  " & _			 "          Event.Age,  " & _			 "          Event.Note1 AS eventnote1,  " & _			 "          Event.Note2 AS eventnote2,  " & _			 "          Event.CreationDate,  " & _			 "          Event.Approved,  " & _			 "          Event.EventType,  " & _			 "          Event.NoOfWeeks,  " & _			 "          Event.PreReq,  " & _			 "          Instructor.Name AS instructorName,  " & _			 "          i_address.Address1 AS instructorAddress1, " & _ 			 "          i_address.Address2 AS instructorAddress2,  " & _			 "          i_address.City AS instructorcity,  " & _			 "          i_address.State AS instructorstate,  " & _			 "          i_address.Country AS instructorcountry,  " & _			 "          i_address.Zip AS instructorzip,  " & _			 "          i_address.Phone AS instructorphone,  " & _			 "          i_address.Fax AS instructorfax,  " & _			 "          i_internet.email AS instructoremail,  " & _			 "          i_internet.URL AS instructorURL,  " & _			 "          Bandtable.Name AS bandname,  " & _			 "          b_address.Address1 AS bandaddress1, " & _ 			 "          b_address.Address2 AS bandaddress2,  " & _			 "          b_address.City AS bandcity,  " & _			 "          b_address.Country AS bandcountry,  " & _			 "          b_address.State AS bandstate,  " & _			 "          b_address.Zip AS bandzip,  " & _			 "          b_address.Phone AS bandphone,  " & _			 "          b_address.Fax AS bandfax,  " & _			 "          b_internet.email AS bandemail,  " & _			 "          b_internet.URL AS bandurl,  " & _			 "          Venue.Name AS venuename,  " & _			 "          v_address.Address1 AS venueaddress1,  " & _			 "          v_address.Address2 AS venueaddress2,  " & _			 "          v_address.City AS venuecity,  " & _			 "          v_address.State AS venuestate,  " & _			 "          v_address.Country AS venuecountry,  " & _			 "          v_address.Zip AS venuezip,  " & _			 "          v_address.Phone AS venuephone,  " & _			 "          v_address.Fax AS venuefax,  " & _			 "          v_internet.email AS venueemail,  " & _			 "          v_internet.URL AS venueurl,  " & _			 "          Venue.Size AS venuesize,  " & _			 "          Venue.Note1 AS venuenote1,  " & _			 "          Venue.Note2 AS venuenote2  " & _	" FROM Internet AS v_internet RIGHT JOIN (Address AS v_address RIGHT JOIN (Address AS b_address RIGHT JOIN (((Band as bandtable LEFT JOIN Internet AS b_internet ON bandtable.InternetID = b_internet.InternetID) RIGHT JOIN ((Instructor RIGHT JOIN (Venue RIGHT JOIN Event ON Venue.VenueID = Event.VenueID) ON Instructor.InstructorID = Event.InstructorID) LEFT JOIN Internet AS i_internet ON Instructor.InternetID = i_internet.InternetID) ON bandtable.BandID = Event.BandID) LEFT JOIN Address AS i_address ON Instructor.AddressID = i_address.AddressID) ON b_address.AddressID = bandtable.AddressID) ON v_address.AddressID = Venue.AddressID) ON " & _" v_internet.InternetID = Venue.InternetID " & _" WHERE event.approved = '" & strApproved & "'" & _" AND event.eventtype IN (" & strEventTypeList & " 'XXX')" & _" AND event.national <> " & TRUE & _ " AND date >= #" & datBeginDate & "#" & _" AND date <= #" & datEndDate & "#"			  	If lngBandID <> "" AND lngBandID <> DEFAULT Then		'REsponse.Write("<h1>hasd</h1>")		tempSQL = tempSQL & " AND event.bandid = " & lngBandID	End If		If lngVenueID <> "" AND lngVenueID <> DEFAULT Then		tempSQL = tempSQL & " AND event.venueid = " & lngVenueID		'Response.Write("<h1>venueid</h1>")	End If			If lngInstructorID <> "" AND lngInstructorID <> DEFAULT Then		tempSQL = tempSQL & " AND event.Instructorid = " & lngInstructorID	End If		If lngEventID <> "" AND lngEventID <> DEFAULT Then				tempSQL = tempSQL & " AND event.eventid = " & lngEventID	End If		tempSQL = tempSQL & " ORDER BY DATE " 				'Response.Write(tempSQL)End Sub 'BuildSQL()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub SetDefaults()		If strEventTypeList = "" Then		strEventTypeList = "'" & LESSON & "', '" & SHOWDJ & "', '" & WORKSHOP & "', '" & OTHER & "',"		strLesson = YES		strWorkshop = YES		strShowDJ = YES		strOther = YES	End If		' Response.Write("<h1>jason</h1>")	If strApproved = "" Then		strApproved = APPROVED	End If	End Sub 'SetDefaults()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub GetData()	Set objDBEvent = Server.CreateObject("ADODB.Connection")	objDBEvent.Open DATABASE	Set objRSEvent = objDBEvent.Execute(tempSQL)		End Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub GetEventSet( TEMPlngBandID,TEMPlngVenueID,TEMPlngInstructorID,TEMPstrLesson, TEMPstrShowDJ,TEMPstrOther, TEMPstrWorkshop,TEMPdatBeginDate, TEMPdatEndDate,TEMPstrApproved, TEMPlngEventID)strEventTypeList = ""lngBandID = TEMPlngBandID'Response.Write("<h1>"&lngBandID&"....</h1>")lngVenueID = TEMPlngVenueIDlngInstructorID = TEMPlngInstructorIDstrLesson    = TEMPstrLessonstrShowDJ = TEMPstrShowDJ'Response.Write("<hr>" & strShowDJ & "<hr>")strOther = TEMPstrOtherstrWorkshop = TEMPstrWorkshopdatBeginDate = TEMPdatBeginDatedatEndDate = TEMPdatEndDatestrApproved = TEMPstrApprovedlngEventID = TEMPlngEventIDGetOptions()SetDefaults()BuildSQL()'Response.Write(tempSQL & "<HR>")GetData()'ShowData()End Sub 'GetEventSet()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Dim lngBandIDDim lngVenueIDDim lngInstructorIDDim strLesson   'YES or NODim strShowDJDim strOtherDim strWorkshopDim datBeginDateDim datEndDateDim strStyleDim strEventTypeListDim strApprovedDim lngEventIDDim tempSQLDim objRSEventDim objDBEvent%>