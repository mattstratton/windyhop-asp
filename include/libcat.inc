<% Function ReturnCatID(strName,intTableID)	Dim localSQL	Dim objLocalDB	Dim objLocalRS	Set objLocalDB = Server.CreateObject("ADODB.Connection")	objLocalDB.Open DATABASE	localSQL = "Select CategoryID from Category WHERE Name = '" & strName & "' AND TableID = " & intTableID	Response.Write("Here's the ReturnCat SQL: " & localSQL & "<br>")	Set objLocalRS = objlocalDB.Execute(localSQL)	' Note: Need to have some kind of exception if returns nothing	If objLocalRS.EOF Then		ReturnCatID = 0	Else		ReturnCatID = objLocalRS("CategoryID")	End If	objLocalRS.Close	objLocalDB.CloseEnd Function	'ReturnCatIDSub CreateLink(intID1,intID2,intLinkType)		Dim localSQL	Dim objLocalDB	Dim objLocalRS	Dim longLinkID	If intID1 = 0 Then		intID1 = ReturnCatID(" unfiled",2)	End If	localSQL = "Select LinkID from Link where ID2 = " & intID2 & " AND LinkType = " & intLinkType	'Response.Write(localSQL)	Set objLocalDB = Server.CreateObject("ADODB.Connection")	objLocalDB.Open DATABASE	Set objLocalRS = objLocalDB.Execute(localSQL)	If Not objLocalRS.EOF Then		longLinkID = objLocalRS("LinkID")	Else		longLinkID = 0	End If	objLocalRS.Close			If longLinkID = 0 Then		Response.Write("Creating New Link")		Set objLocalRS = Server.CreateObject("ADODB.Recordset")		objLocalRS.open "link", objLocalDB, adOpenKeyset, adLockOptimistic		objLocalRS.AddNew	Else		objLocalRS.open "select * from Link where LinkID = " & longLinkID, _		objLocalDB, adOpenKeyset, adLockOptimistic	End If	objLocalRS("ID1") = intID1	objLocalRS("ID2") = intID2	objLocalRS("LinkType") = intLinkType	objLocalRS.Update	objLocalRS.Close	objLocalDB.Close	End Sub	'CreateLink%>