	<%	Option Explicit		Dim objDB	Dim strSQL	Dim objRS	Dim sDBName		Dim sAction	const CURRENT_PAGE = "query.asp"%><!-- #include file="../include/globalc.inc" -->	<!-- #include file="../include/getname.inc" -->	<!-- #include file="../include/approvedtext.inc" -->	<!-- #include file="../include/libformobjects.inc" -->	<!-- #include file="../include/managemenubar.inc" -->	<%'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildSQLForm()%><form action=<%=CURRENT_PAGE%>?action=submit method=post name=query><h1> SwingHomeChicago.com Query Page </h1><h2>Enter SQL to run against Database</h2><br><a href=<%=CURRENT_PAGE%>>Reset Form</a><br><br><table><tr><td><textarea name=sql cols=80 rows=20>select * from user</textarea><p><input type=submit value=submit name=submit></form></td>	<td>	<%End Sub 'BuildSQLForm()'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub ReturnResults()	On Error Resume Next	Dim strSQL	Dim objDB	Dim objRS	Dim iCount	Dim oField		strSQL = Request.Form("sql")	   	Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE   	Set objRS = Server.CreateObject("ADODB.Recordset")				objRS.Open strSQL, objDB	If Err.number <> 0 Then		%>		<h1>Error</h1>		<a href=<%=CURRENT_PAGE%>>Reset</a><p>		<table>		<tr><td>Error Number:</td><td> <%=Err.number%></td></tr>		<tr><td>Error Description:</td><td> <%=Err.description %></td></tr>		<tr><td>Error helpcontext:</td><td> <%=Err.helpcontext %></td></tr>		<tr><td>Error Source:</td><td> <%=Err.source %></td></tr>		</table>				<%		Exit Sub	End If	%>	<table border=1><tr>	<%	For Each oField In objRS.Fields 		%>		<td bgcolor=blue><b><%=ucase(oField.Name)%></b></td>		<%		Next	%>	</tr>	<%	Do While Not objRS.EOF	%> <tr> <%		For Each oField in objRS.Fields 			%>			<td><%=oField.Value%></td>			<%		Next		objRS.MoveNext	%></tr><%	Loop	%></table><%	objRS.Close	Set objRS = NothingEnd Sub'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub ReturnDesc()	'On Error Resume Next	Dim strSQL	Dim objDB	Dim objRS	Dim iCount	Dim oField		strSQL = "Select * from " & Request.Form("tablename") 		Response.Write(strSQL)   	Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE   	Set objRS = Server.CreateObject("ADODB.Recordset")				objRS.Open strSQL, objDB	%>	<table border=1>	<%	For Each oField In objRS.Fields 		%>		<tr><td><%=ucase(oField.Name)%></td></tr>		<%		Next	%>	</table><%	objRS.Close	Set objRS = NothingEnd Sub'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildDescForm()	%>	<h2>Describe Table</h2>	<form action=<%=CURRENT_PAGE%>?action=describe method=post name=query>	<input name=tablename><p>	<input type=submit value=Describe name=submit>	</form><%End Sub 'BuildDescForm()'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''sAction=lcase(Request.QueryString("action"))Select Case sAction	Case "submit"		ReturnResults()	Case "describe"		BuildSQLForm()		ReturnDesc()		%>		</td></tr></table>		<%	Case Else		BuildSQLForm()		BuildDescForm()		%>		</td></tr></table>		<%End Select%>