	<%	Option Explicit		Dim objDB	Dim strSQL	Dim objRS	Dim sDBName		Dim sAction	%><!-- #include file="../include/globalc.inc" -->	<!-- #include file="../include/getname.inc" -->	<!-- #include file="../include/approvedtext.inc" -->	<!-- #include file="../include/libformobjects.inc" -->	<!-- #include file="../include/managemenubar.inc" -->	<!-- #include file="../include/hasrights.inc" -->	<%''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildManageNewsTable()	Dim counter	Dim strOrderBy		counter = 0	If Request.QueryString("orderby") = "" Then		strOrderBy = " Priority "	Else		strOrderBy = " "&Request.QueryString("orderby")&" "	End If	%>		<TABLE BORDER=hrows>	  <TR>	<!-- Build the Table Header -->	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>NewsID</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Delete</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Approve</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>		<a href=approve.asp?action=ManageNews&select=<%=Request.QueryString("select")%>&orderby=priority>		Priority</a></B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Title</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Blurb</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>				<a href=approve.asp?action=ManageNews&select=<%=Request.QueryString("select")%>&orderby=begineffdate>		BeginDate</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>				<a href=approve.asp?action=ManageNews&select=<%=Request.QueryString("select")%>&orderby=endeffdate>				EndDate</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>		<a href=approve.asp?action=ManageNews&select=<%=Request.QueryString("select")%>&orderby=creationdate>		Creation Date</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Owner</B></FONT></TD>	  </TR>	<% 	' Declare the variables and objects that will be used in the program	   	Set objDB = Server.CreateObject("ADODB.Connection")		objDB.Open DATABASE	   		Set objRS = Server.CreateObject("ADODB.Recordset")				Select Case Request.QueryString("select")			Case ALLRECORDS				strSQL = "SELECT * from News"& " ORDER BY " & strOrderBy			Case APPROVED				strSQL = "SELECT * from News where approved = '" & APPROVED & "'" & "ORDER BY " & strOrderBy			Case NOTAPPROVED				strSQL = "SELECT * from News where approved = '" & NOTAPPROVED & "'"& "ORDER BY " & strOrderBy			Case Else				strSQL = "SELECT * from News where approved = '" & NOTAPPROVED & "'" & "ORDER BY " & strOrderBy		End Select			Response.Write(strSQL)					  objRS.Open strSQL, objDB	Response.Write ("<form name=approve_form action=approve.asp?action=SubmitNews method=POST>")	' Iterate through the Recordset using a Looping structure	Do while not objRS.EOF    	%>	  <!-- HTML code to print the results to the client -->	  <TR>	    <TD><%= objRS("NewsID") %></TD>		<td>		<%			If HasRights("deletenews", Session("userlevel")) Then			Response.Write("<INPUT TYPE=CHECKBOX NAME=delete?" & objRS("NewsID") & " VALUE=" & APPROVED & ">")		Else			Response.Write("X")		End If		%></td><td>		<%		If objRS("Approved") = APPROVED Then			Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS("NewsID") & " VALUE=" & APPROVED & " CHECKED >")		Else			Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS("NewsID") & " VALUE=" & APPROVED & ">")		End If		Response.Write(counter)		Response.Write("</td>")		Response.Write("<INPUT TYPE=HIDDEN NAME=formid?" & counter & " value=" & objRS("NewsID") & ">")				%>		<TD><% BuildPriorityRadio objRS("priority"),objRS("newsID") %></td>						<%		Dim fso		set fso = CreateObject("Scripting.FileSystemObject")				Dim newsText		Set newsText = fso.OpenTextFile(Server.Mappath(NEWS_DIRECTORY & objRS("filename")))		Response.Write("<td>"&newsText.ReadLine&"</td>")		newsText.SkipLine		Response.Write("<td>"&newsText.ReadLine&"</td>")		newsText.Close		%>					    <TD><%= objRS("BeginEffDate") %></TD>	    <TD><%= objRS("EndEffDate") %></TD>	    <TD><%= objRS("CreationDate") %></TD>	    <TD><%= GetName("user", "login", objRS("userid")) %></TD>	    	   	     </TR>	  	<% 	' Retrieve the Next Record			counter = counter + 1
			    objRS.MoveNext	' Go to the Top of the Loop to Process the Next Record	    Loop	    	    Response.Write("<INPUT TYPE=HIDDEN NAME=NoOfUserApproval value=" & counter & ">")			    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("<a href=approve.asp?action=ManageNews&select=" & ALLRECORDS & "> [Select ALL News]  </a>")	    Response.Write("<a href=approve.asp?action=ManageNews&select=" & APPROVED & "> [Select Approved News] </a>")	    Response.Write("<a href=approve.asp?action=ManageNews&select=" & NOTAPPROVED & "> [Select Not Approved News] </a>")	    Response.Write("<br><br>")	    Response.Write("</table>")	    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("</form>")	' Close the RecordSet Object				    objRS.Close	    objDB.Close	    	    	    End Sub ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub SubmitNews()	Dim temp		Dim x	Dim iCurrentNews	Dim iApproved	Dim iDelete	Dim iPriority	Dim strSQL		Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE		Response.Write("<br><b>RESULTS OF MANAGING NEWS: </b><br>")	Response.Write("Total News to Manage : " & Request.Form("NoOfUserApproval") & "<br>")	Response.Write("<table border=1>")	For x = 0 To Request.Form("NoOfUserApproval") - 1		Response.Write("<tr>")		iCurrentNews = Request.Form("formid?" & x )		iApproved = Request.Form("approved?" & iCurrentNews )		iDelete   = Request.Form("delete?" & iCurrentNews )		iPriority = Request.Form("priority"& iCurrentNews )				''''''''''''''''''''		' UPDATE PRIORITY		''''''''''''''''''''		strSQL = " UPDATE News " & _				 " SET priority = " & iPriority &  _ 				 " WHERE NewsID = " & iCurrentNews		objDB.Execute(strSQL)		Response.Write("<td>")		Response.Write(GetName("news", "name", iCurrentNews) & "</td><td> PRIORITY = " & iPriority &"</td>")		''''''''''''''''''''		' UPDATE APPROVED STATUS		''''''''''''''''''''		If iApproved <> APPROVED Then			iApproved = NOTAPPROVED		End If				strSQL = " UPDATE News " & _				 " SET approved = " & iApproved &  _ 				 " WHERE NewsID = " & iCurrentNews		objDB.Execute(strSQL)		Response.Write("<td>")		Response.Write(ApprovedText(iApproved))		Response.Write("</td>")		'End If		Response.Write("<td>")		If iDelete = APPROVED Then			strSQL = " DELETE FROM News " & _					 " WHERE NewsID = " & iCurrentNews			'Response.Write(strSQL & "<hr>")			temp = GetName("news", "name", iCurrentNews)			objDB.Execute(strSQL)			Response.Write("DELETED")		End If		Response.Write("</td>")		Response.Write("</tr>")	Next	Response.Write("</table>")	Response.Write("<blockquote>Update Successful!<p><a href=admin.asp>Return</a></blockquote>")	Response.EndEnd Sub 'SubmitNews()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildManageUserTable()	Dim counter		counter = 0	%>	<h1>MANAGE USERS</H1>	<TABLE BORDER=hrows>	  <TR>	<!-- Build the Table Header -->	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>UserID</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Delete</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Approve</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Login</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>First Name</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Last Name</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Email</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Password</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Created</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Zip</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>UserLevel</B></FONT></TD>	  </TR>	<% 	' Declare the variables and objects that will be used in the program	   	Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE	   		Set objRS = Server.CreateObject("ADODB.Recordset")				Select Case Request.QueryString("select")			Case ALLRECORDS				strSQL = "SELECT * from User"			Case APPROVED				strSQL = "SELECT * from User where approved = '" & APPROVED & "'"			Case NOTAPPROVED				strSQL = "SELECT * from User where approved = '" & NOTAPPROVED & "'"			Case Else				strSQL = "SELECT * from User where approved = '" & NOTAPPROVED & "'"			End Select			Response.Write(strSQL)	  objRS.Open strSQL, objDB	Response.Write ("<form name=approve_form action=approve.asp?action=SubmitUser method=POST>")	' Iterate through the Recordset using a Looping structure	Do while not objRS.EOF    	%>	  <!-- HTML code to print the results to the client -->	  <TR>	    <TD><%= objRS("UserID") %></TD>		<%		If HasRights("deleteusers", Session("userlevel")) Then			Response.Write("<td><INPUT TYPE=CHECKBOX NAME=delete?" & objRS("UserID") & " VALUE=" & APPROVED & "></td><td>")		Else			Response.Write("<TD>X</td><td>")		End If		'Response.Write("<td><INPUT TYPE=CHECKBOX NAME=delete?" & objRS("UserID") & " VALUE=" & APPROVED & "></td><td>")		If HasRights("approveusers", Session("userlevel")) Then			If objRS("Approved") = APPROVED Then				Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS("UserID") & " VALUE=" & APPROVED & " CHECKED >")			Else				Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS("UserID") & " VALUE=" & APPROVED & ">")			End If		Else			Response.Write("X ")		End If				Response.Write(counter)		Response.Write("</td>")		Response.Write("<INPUT TYPE=HIDDEN NAME=formid?" & counter & " value=" & objRS("UserID") & ">")				%>			    <TD><%= objRS("login") %></TD>	    <TD><%= objRS("firstname") %></TD>	    <TD><%= objRS("lastname") %></TD>	    <TD><a href=mailto:<%= objRS("email") %>><%= objRS("email") %></a></TD>	    <TD><% 					If Request.QueryString("bob") <> "Y" Then					If objRS("password") = RANDOMPASSWORD or objRS("password") = RANDOMPASSWORD Then						Response.Write("RANDOM")					Else						Response.Write("********")					End If				Else					Response.Write(objRS("password"))				End If		 %></TD>	    <TD><%= objRS("creationdate") %></TD>	    <TD><%= objRS("zip") %></TD>	    <TD><%= objRS("userlevel") %></TD>	    	   	     </TR>	  	<% 	' Retrieve the Next Record			counter = counter + 1			    objRS.MoveNext	' Go to the Top of the Loop to Process the Next Record	    Loop	    	    Response.Write("<INPUT TYPE=HIDDEN NAME=NoOfUserApproval value=" & counter & ">")			    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("<a href=approve.asp?action=ManageUsers&select=" & ALLRECORDS & "> [Select ALL Users]  </a>")	    Response.Write("<a href=approve.asp?action=ManageUsers&select=" & APPROVED & "> [Select Approved Users] </a>")	    Response.Write("<a href=approve.asp?action=ManageUsers&select=" & NOTAPPROVED & "> [Select Not Approved Users] </a>")	    Response.Write("<br><br>")	    Response.Write("</table>")	    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("</form>")	' Close the RecordSet Object				    objRS.Close	    objDB.Close	    	    	    End Sub 'BuildManageUserTable()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub SubmitUpdates(strTable)	Dim temp		Dim x	Dim iCurrentRecord	Dim iApproved	Dim iDelete	Dim strSQL		Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE		For x = 0 To Request.Form("NoOf"&strTable&"sApproval") - 1			iCurrentRecord = Request.Form("formid?" & x )						iApproved = Request.Form("approved?" & iCurrentRecord )		iDelete   = Request.Form("delete?" & iCurrentRecord )				If iApproved <> APPROVED Then			iApproved = NOTAPPROVED		End If				strSQL = " UPDATE "&strTable&" " & _				 " SET approved = " & iApproved &  _ 				 " WHERE "&strTable&"id = " & iCurrentRecord		 		'Response.Write(strSQL & "<br><br>")		Response.Write(GetName(strTable, "name", iCurrentRecord) & " is " & ApprovedText(iApproved) &"<br>")		'End		objDB.Execute(strSQL)						If iDelete = APPROVED Then			strSQL = " DELETE FROM "&strTable&" " & _					 " WHERE "&strTable&"ID = " & iCurrentRecord			'Response.Write(strSQL & "<hr>")			temp = GetName(strTable, "name", iCurrentRecord)			objDB.Execute(strSQL)			Response.Write(temp & " is DELETED<br>")		End If	Next	Response.Write("<blockquote>Update Successful!<p><a href=admin.asp>Return</a></blockquote>")                Response.EndEnd Sub 'SubmitUpdates()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub SubmitUser()	Dim temp		Dim x	Dim iCurrentUser	Dim iApproved	Dim iDelete	Dim strSQL		Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE		Response.Write("<b>RESULTS OF MANAGING USERS: </b><br>")	Response.Write("Total Users to Manage : " & Request.Form("NoOfUserApproval") & "<br>")		For x = 0 To Request.Form("NoOfUserApproval") - 1			iCurrentUser = Request.Form("formid?" & x )		'Response.Write("Current User : " & iCurrentUser & "<br>")							iApproved = Request.Form("approved?" & iCurrentUser )		iDelete   = Request.Form("delete?" & iCurrentUser )				If iApproved <> APPROVED Then			iApproved = NOTAPPROVED		End If					strSQL = " UPDATE User " & _					 " SET approved = " & iApproved &  _ 					 " WHERE userid = " & iCurrentUser			'Response.Write(strSQL)			objDB.Execute(strSQL)					Response.Write(GetName("user", "login", iCurrentUser) & " is " & ApprovedText(iApproved) &"<br>")		'End If				If iDelete = APPROVED Then			strSQL = " DELETE FROM User " & _					 " WHERE userID = " & iCurrentUser			'Response.Write(strSQL & "<hr>")			temp = GetName("user", "login", iCurrentUser)			objDB.Execute(strSQL)			Response.Write(temp & " is DELETED<br>")		End If				    	Next	Response.Write("<blockquote>Update Successful!<p><a href=admin.asp>Return</a></blockquote>")                Response.EndEnd Sub 'SubmitUser()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub SubmitEvents()	Dim temp		Dim x	Dim iCurrentEvent	Dim iApproved	Dim iDelete	Dim strSQL		Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE		Response.Write("<b>RESULTS OF MANAGING EVENTS: </b><br>")	Response.Write("Total Events to Manage : " & Request.Form("NoOfUserApproval") & "<br>")		For x = 0 To Request.Form("NoOfUserApproval") - 1			iCurrentEvent = Request.Form("formid?" & x )		iApproved = Request.Form("approved?" & iCurrentEvent )		iDelete   = Request.Form("delete?" & iCurrentEvent )				If iApproved <> APPROVED Then			iApproved = NOTAPPROVED		End If					strSQL = " UPDATE Event " & _					 " SET approved = " & iApproved &  _ 					 " WHERE EventID = " & iCurrentEvent			'Response.Write(strSQL)			objDB.Execute(strSQL)					Response.Write(GetName("event", "name", iCurrentevent) & " is " & ApprovedText(iApproved) &"<br>")		'End If				If iDelete = APPROVED Then			strSQL = " DELETE FROM event " & _					 " WHERE eventID = " & iCurrentEvent			'Response.Write(strSQL & "<hr>")			temp = GetName("event", "name", iCurrentEvent)			objDB.Execute(strSQL)			Response.Write(temp & " is DELETED<br>")		End If				    	Next	Response.Write("<blockquote>Update Successful!<p><a href=admin.asp>Return</a></blockquote>")                Response.EndEnd Sub 'SubmitEvents()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildManageEventTable()	Dim counter	CONST USERCREATED = "usercreated"		counter = 0	%>		<TABLE BORDER=hrows>	  <TR>	<!-- Build the Table Header -->	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>EventID</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Delete</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Approve</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Name</B></FONT></TD>		<TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Owner</B></FONT></TD>		<TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Date</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Event Type</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Venue</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Band</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Instructor</B></FONT></TD>  		<TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Lesson Time</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Show Time</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>End Time</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Price</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Age</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Note1</B></FONT></TD>    	<TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Note2</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>User</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B># of Weeks</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Pre Req</B></FONT></TD>		  </TR>  	<% 	' Declare the variables and objects that will be used in the program	   	Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE	   		Set objRS = Server.CreateObject("ADODB.Recordset")				Select Case Request.QueryString("select")			Case ALLRECORDS				strSQL = "SELECT * from Event  order by date desc"			Case APPROVED				strSQL = "SELECT * from Event where approved = '" & APPROVED & "'  order by date desc"			Case NOTAPPROVED				strSQL = "SELECT * from Event where approved = '" & NOTAPPROVED & "' order by date desc"			Case USERCREATED				strSQL = "SELECT * from Event where userid <> 28 order by date desc"			Case Else				strSQL = "SELECT * from Event where approved = '" & NOTAPPROVED & "' order by date desc"			End Select			Response.Write(strSQL)					  objRS.Open strSQL, objDB	Response.Write ("<form name=approve_form action=approve.asp?action=SubmitEvents method=POST>")	' Iterate through the Recordset using a Looping structure	Do while not objRS.EOF    	%>	  <!-- HTML code to print the results to the client -->	  <TR>	    <TD><%= objRS("EventID") %></TD>		<%			If HasRights("deleteevent", Session("userlevel")) Then			Response.Write("<td><INPUT TYPE=CHECKBOX NAME=delete?" & objRS("EventID") & " VALUE=" & APPROVED & "></td><td>")		Else			Response.Write("<td>X</td><td>")		End If				If objRS("Approved") = APPROVED Then			Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS("EventID") & " VALUE=" & APPROVED & " CHECKED >")		Else			Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS("EventID") & " VALUE=" & APPROVED & ">")		End If		Response.Write(counter)		Response.Write("</td>")		Response.Write("<INPUT TYPE=HIDDEN NAME=formid?" & counter & " value=" & objRS("EventID") & ">")				%>			    <TD><%= objRS("name") %></TD>	    <TD><%=  GetName("User", "login", objRS("userid")) %></TD>	    <TD><%= objRS("date") %></TD>	    <TD><%= objRS("eventtype") %></TD>		<TD><%=  GetName("Venue", "Name", objRS("Venueid")) %></TD>	    <TD><%=  GetName("Band", "Name", objRS("Bandid")) %></TD>	    <TD><%=  GetName("Instructor", "Name", objRS("Instructorid")) %></TD>	    <TD><%= objRS("lessontime") %></TD>	    <TD><%= objRS("showtime") %></TD>	    <TD><%= objRS("endtime") %></TD>	   	    <TD><%= objRS("price") %></TD>	    <TD><%= objRS("age") %></TD>	    <TD><%= objRS("note1") %></TD>		    <TD><%= objRS("note2") %></TD>	    <TD><%=  GetName("User", "Login", objRS("Userid")) %></TD>	    <TD><%= objRS("noofweeks") %></TD>	    <TD><%= objRS("prereq") %></TD>	        </TR>	  	<%	 	' Retrieve the Next Record			counter = counter + 1			    objRS.MoveNext	' Go to the Top of the Loop to Process the Next Record	    Loop	    	    Response.Write("<INPUT TYPE=HIDDEN NAME=NoOfUserApproval value=" & counter & ">")			    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("<a href=approve.asp?action=ManageEvents&select=" & ALLRECORDS & "> [Select ALL Events]  </a>")	    Response.Write("<a href=approve.asp?action=ManageEvents&select=" & APPROVED & "> [Select Approved Events] </a>")	    Response.Write("<a href=approve.asp?action=ManageEvents&select=" & NOTAPPROVED & "> [Select Not Approved Events] </a>")		Response.Write("<a href=approve.asp?action=ManageEvents&select=" & USERCREATED & "> [Select User Created Events] </a>")			    Response.Write("<br><br>")	    Response.Write("</table>")	    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("</form>")	' Close the RecordSet Object			    objRS.Close	    objDB.Close	    End Sub 'BuildManageEventTable()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub BuildManageTable(strTable)	Dim counter		counter = 0	%>	<h1>MANAGE <%=ucase(strTable)%></h1>	<TABLE BORDER=hrows>	  <TR>	<!-- Build the Table Header -->	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>ID</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Delete</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Approve</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Name</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Address1</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Address2</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>City</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>State</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Country</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Phone</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Fax</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>email</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>URL</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>owner</B></FONT></TD>	    <TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Note1</B></FONT></TD>    	<TD ALIGN="center" BGCOLOR="#669999"><FONT SIZE="3" COLOR="white"><B>Note2</B></FONT></TD>	
	  </TR>	<% 	' Declare the variables and objects that will be used in the program	   	Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE	   		Set objRS = Server.CreateObject("ADODB.Recordset")						strSQL = "SELECT "&strTable&"Table."&strTable&"ID, " & _				 " "&strTable&"Table.Name, " & _				 " "&strTable&"Table.Approved, " & _				 " "&strTable&"Table.Note1, " & _				 " "&strTable&"Table.Note2, " & _				 " Address.Address1, " & _				 " Address.Address2, " & _				 " Address.City, " & _				 " Address.State, " & _				 " Address.Country, " & _				 " Address.Zip, " & _				 " Address.Phone, " & _				 " Address.Fax, " & _				 " Internet.email, " & _				 " User.login, " & _				 " Internet.URL " & _				 " FROM (Internet RIGHT JOIN (Address RIGHT JOIN "&strTable&" AS "&strTable&"Table " & _				 "  ON Address.AddressID = "&strTable&"Table.AddressID) " & _				 "  ON Internet.InternetID = "&strTable&"Table.InternetID ) " & _				  " INNER JOIN User ON "&strTable&"Table.UserID = User.UserID " 				 		Select Case Request.QueryString("select")			Case ALLRECORDS				strSQL = strSQL & " order by name"			Case APPROVED				strSQL = strSQL & " where "&strTable&"Table.approved = '" & APPROVED & "' order by name"			Case NOTAPPROVED				strSQL = strSQL & " where "&strTable&"Table.approved = '" & NOTAPPROVED & "' order by name"			Case Else				strSQL = strSQL & " where "&strTable&"Table.approved = '" & NOTAPPROVED & "' order by name"			End Select						Response.Write strSQL					  objRS.Open strSQL, objDB	Response.Write ("<form name=approve_form action=approve.asp?action=submit&table="&strTable&" method=POST>")	' Iterate through the Recordset using a Looping structure	Do while not objRS.EOF    	%>	  <!-- HTML code to print the results to the client -->	  <TR>						    <TD><%= objRS(strTable&"ID") %></TD>		<%			If HasRights("deletevbi", Session("userlevel")) Then			Response.Write("<td><INPUT TYPE=CHECKBOX NAME=delete?" & objRS(strTable&"ID") & " VALUE=" & APPROVED & "></td><td>")		Else			Response.Write("<td>X</td><td>")		End If									If objRS("Approved") = APPROVED Then			Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS(strTable&"ID") & " VALUE=" & APPROVED & " CHECKED >")		Else			Response.Write("<INPUT TYPE=CHECKBOX NAME=approved?" & objRS(strTable&"ID") & " VALUE=" & APPROVED & ">")		End If		Response.Write(counter)		Response.Write("<INPUT TYPE=HIDDEN NAME=formid?" & counter & " value=" & objRS(strTable&"ID") & ">")				%>		</TD>	    <TD><%= objRS("Name") %></TD>	    <TD><%= objRS("Address1") %></TD>	    <TD><%= objRS("Address2") %></TD>	    <TD><%= objRS("City") %></TD>	    <TD><%= objRS("State") %></TD>	    <TD><%= objRS("Country") %></TD>	    <TD><%= objRS("Phone") %></TD>	    <TD><%= objRS("Fax") %></TD>	    <TD><a href=mailto:<%= objRS("email") %>><%= objRS("email") %></a></TD>	    <TD><a href=<%= objRS("URL")%> TARGET=_blank><%= objRS("URL")%></a></TD>		<TD><%= objRS("login") %></TD>	    <TD><%= objRS("note1") %></TD>	    <TD><%= objRS("note2") %></TD>	   	   	     </TR>	  	<% 	' Retrieve the Next Record			counter = counter + 1			    objRS.MoveNext	' Go to the Top of the Loop to Process the Next Record	    Loop	    	    Response.Write("<INPUT TYPE=HIDDEN NAME=NoOf"&strTable&"sApproval value=" & counter & ">")			    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("<a href=approve.asp?action=manage&table="&strTable&"&select=" & ALLRECORDS & "> [Select ALL "&strTable&"s]  </a>")	    Response.Write("<a href=approve.asp?action=manage&table="&strTable&"&select=" & APPROVED & "> [Select Approved "&strTable&"s] </a>")	    Response.Write("<a href=approve.asp?action=manage&table="&strTable&"&select=" & NOTAPPROVED & "> [Select Not Approved "&strTable&"s] </a>")	    Response.Write("<a href=admin.asp> [ADMIN HOME] </a>")	  	    Response.Write("<br><br>")	    Response.Write("</table>")	    Response.Write("<input type=submit value=submit name=submit>")	    Response.Write("</form>")	    objRS.Close	    objDB.Close    End Sub 'BuildManageTable()'''''''''''''''''''''''''''''''''''''''''''If Not HasRights("viewapprovepage", Session("userlevel")) Then	Response.Redirect("default.asp")End IfsAction = Request.QueryString("action")Dim sTablesTable = Request.QueryString("table")Select Case sAction	Case "manage"		Select Case sTable			Case "band"				ManageMenuBar()				BuildManageTable(sTable)			Case "venue"				ManageMenuBar()				BuildManageTable(sTable)			Case "instructor"				ManageMenuBar()				BuildManageTable(sTable)			Case Else				Response.Redirect("admin.asp")		End Select	Case "submit"		Select Case sTable			Case "band"				ManageMenuBar()				SubmitUpdates(sTable)			Case "venue"				ManageMenuBar()				SubmitUpdates(sTable)			Case "instructor"				ManageMenuBar()				SubmitUpdates(sTable)			Case Else				Response.Redirect("admin.asp")		End Select					Case "ManageUsers"		ManageMenuBar()		BuildManageUserTable()	Case "SubmitUser"		ManageMenuBar()		SubmitUser()	Case "ManageEvents"		ManageMenuBar()		BuildManageEventTable()		Case "SubmitEvents"		ManageMenuBar()		SubmitEvents()	Case "ManageNews"		ManageMenuBar()		BuildManageNewsTable()	Case "SubmitNews"		ManageMenuBar()		SubmitNews()	Case Else 		Response.Redirect("admin.asp")	End Select	%>