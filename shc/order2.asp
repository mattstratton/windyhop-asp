<%OPTION EXPLICITSub ProcessForm()		Dim item	Dim form		Set form = Request.Form	For each item in Request.Form			Session(item) = Request.Form(item)			'Response.Write( UCase(item) & ": " & Request.Form(item) & "<br>")	Next	'Response.EndEnd SubProcessForm%><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML><HEAD><TITLE>Windyhop.com</TITLE><SCRIPT>function update_price(qty, price) {	var x	x = qty * price	return x;}function update_grand_total(){		document.all['grand_total'].value = 3 + Number(document.all['7xl_total'].value) + 										Number(document.all['7l_total'].value) + 										Number(document.all['bm_total'].value)}</SCRIPT><LINK REL=STYLESHEET HREF="../include/shc.css"></HEAD><BODY><table width=700 border=0><tr><td>&nbsp;</td></td><td><%PaymentOptions()%><h2>PRODUCTS AND QUANITIES</h2><%ConfirmOfCart()%>  </BODY></HTML><%Sub PaymentOptions()	If Request.QueryString("pp")="y" Then		ConfirmPaypal()		MailConfirmation()	Else		Select Case lcase(Session("payment"))			Case "check" 				ConfirmCheck()				MailConfirmation()			Case "paypal"				GotoPaypal()			Case Else		End Select	End IfEnd Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub ConfirmCheck()	%>	<H1>CONFIRMATION -- CHECK/MONEY ORDER</h1>	<h2>THANK YOU FOR YOUR ORDER!</h2>	Below is a confirmation of your order.  Please send check with your Name, Email, and daytime phone to:<br>			<br><center>		Windyhop<br>		c/o Jason Wyckoff<br>		3815 N. Greenview #1W<br>		Chicago, IL 60613<br>		<b><i>Make payment out to "Jason Wyckoff"</i></b>		<br><br></center>	Once payment has been received, we will send your items.  If you have any questions,	feel free to email us at <a href="mailto:buy@windyhop.org">buy@windyhop.org</a>.	<%End SubSub GotoPaypal()	%>	<H1>CONFIRMATION -- PAYPAL ORDER</h1>	<h2>THANK YOU FOR YOUR ORDER!</h2>	Below is a confirmation of your order.  Please click the button below to pay with Credit Card via PayPal.com. If you have any questions,	feel free to email us at <a href="mailto:buy@windyhop.org">buy@windyhop.org</a>. <br><br>		<br><!-- Begin PayPal Logo --><FORM ACTION="https://secure.paypal.com/cgi-bin/webscr" METHOD="POST" ID=Form2><INPUT TYPE="hidden" NAME="cmd" VALUE="_xclick" ID=Hidden1><INPUT TYPE="hidden" NAME="business" VALUE="buy@windyhop.org" ID=Hidden1><INPUT TYPE="hidden" NAME="return" VALUE="http://www.windyhop.org/shc/paypal_confirm.asp" ID=Hidden1><INPUT TYPE="hidden" NAME="item_name" VALUE="1 order of Windyhop Tshirts (may contain multiple shirts)" ID=Hidden1><INPUT TYPE="hidden" NAME="item_number" VALUE="101" ID=Hidden1><INPUT TYPE="hidden" NAME="amount" VALUE="<%=Session("grand_total")%>" ID=Hidden1><INPUT TYPE="hidden" NAME="no_intl" VALUE="1" ID=Hidden1><INPUT TYPE="hidden" NAME="shipping" VALUE="3" ID=Hidden1><INPUT TYPE="image" SRC="http://images.paypal.com/images/x-click-but3.gif" NAME="submit" ALT="Make payments with PayPal - it's fast, free and secure!" ID=Image1><input type="submit" name=submit value="Pay with Credit Card >>"></FORM><!-- End PayPal Logo -->	<%End Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub ConfirmPayPal()	%>	<h2>You are finished! </h2>	You should receive an email from PayPal confirming your payment to Windyhop.  	We will be sending you your Windyhop products shortly! If you have any questions, feel free	to email us at <a href="mailto:buy@windyhop.org">buy@windyhop.org</a>	<br>	<br>	<a href="/shc/welcome.asp">Back to Windyhop</a>	<%End Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function OneLine(intQty,strItem, strSize, strPrice, strTotal)	Dim strTemp		If IsNumeric(intQty) Then		If(intQty) <> 0 Then			strTemp = strTemp & rpad(intQty," ",7)			strTemp = strTemp & rpad(strItem," ",25)			strTemp = strTemp & rpad(strSize," ",7)			strTemp = strTemp & rpad(strPrice," ",10)			strTemp = strTemp & rpad(strTotal," ",10)			strTemp = strTemp & vbcrlF		End If	Else		strTemp = strTemp & rpad(intQty," ",7)		strTemp = strTemp & rpad(strItem," ",25)		strTemp = strTemp & rpad(strSize," ",7)		strTemp = strTemp & rpad(strPrice," ",10)		strTemp = strTemp & rpad(strTotal," ",10)		strTemp = strTemp & vbcrlF	End If	OneLine = strTempEnd Function''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub MailConfirmation()	Dim Jmail	Dim mailserver	Dim strBody		Set JMail = Server.CreateObject("JMail.SMTPMail") 
	If Request.ServerVariables("SERVER_NAME")= "localhost" Then		mailserver = "mail"	Else		mailserver = "mail.windyhop.org"	End If				Jmail.MailDomain = mailserver		' Who, what, where...	Jmail.SenderName = "Windyhop Order"	Jmail.Sender = "buy@windyhop.org"	Jmail.AddRecipient Session("email")	Jmail.AddRecipientBCC "buy@windyhop.org"		Jmail.Subject = "Cofirmation for " & Session ("first name") & " " & Session("last name")		strBody = strBody & "Dear " & Session("first name") & "," & vbcrlf	strBody = strBody & vbcrlf	strBody = strBody & ChopToWidth("Thank you for your order!  If you are paying by check or money order, please send the payment the address below.  If you have paid by credit card via PayPal.com, make sure you have visited PayPal.com and have received a confirmation email from them.",60)	'''''''''''''''''''''''''    strBody = strBody & vbcrlf & vbcrlf & OneLine("Qty","Item","Size", "Price", "Total")    strBody = strBody & OneLine("---","----","----", "-----", "-----")	strBody = strBody & OneLine(Session("7xl"),"Seven Sins", "XL", "$10.00", "$" & Session("7xl_total"))	strBody = strBody & OneLine(Session("7l"),"Seven Sins", "L", "$10.00", "$" & Session("7l_total"))	strBody = strBody & OneLine(Session("bm"),"Baby Doll - Black", "M", "$10.00", "$" & Session("bm_total"))	strBody = strBody & OneLine(" ", "Standard UPS Shipping"," ", " ","$ 3")	strBody = strBody & OneLine(" ", "GRAND TOTAL"," ", " ", "$" & Session("grand_total"))	strBody = strBody & vbcrlf& vbcrlf & ChopToWidth ("Thanks again for your order.  If you have any questions, feel free to contact us at buy@windyhop.org",60)	strBody = strBody & vbcrlf& vbcrlf & "Regards," & vbcrlf & "Punches, Mugsy, and the Windyhop Team"	'''''''''''''''''''''''''		strBody = strBody & vbcrlf & vbcrlf & "Windyhop" & vbcrlf & _		"c/o Jason Wyckoff" & vbcrlf & _		"3815 N. Greenview #1W" & vbcrlf & _		"Chicago, IL 60613" & vbcrlf & _		"Make payment out to 'Jason Wyckoff'" & vbcrlf			Jmail.Body = strBody			Jmail.Execute	End Sub'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub ConfirmOfCart()%><table cellspacing=1 cellpadding=1 width="414" border=1 height=95>  <tr>    <td style="WIDTH: 58px"><b>Quantity</b></td>    <td style="WIDTH: 151px"><b>Shirt</b></td>    <td style="WIDTH: 43px">      <p align=center><b>Size</b></p></td>    <td style="WIDTH: 70px">      <p align=right><b>Price</b></p></td>    <td>      <p align=right><b>Total</b></p></td>        </tr>  <!----------------------->  <tr>    <td style="WIDTH: 58px"><%=Session("7xl")%> </td>    <td style="WIDTH: 151px">"Seven Sins"</td>    <td style="WIDTH: 43px">      <p align=center>XL</p></td>    <td style="WIDTH: 70px">      <p align=right>$10.00</p></td>	<td>      <p align=right>$<%=Session("7xl_total")%></p></td>    </tr>  <!----------------------->  <!----------------------->  <tr>    <td style="WIDTH: 58px"><%=Session("7l")%></td>    <td style="WIDTH: 151px">"Seven Sins"</td>    <td style="WIDTH: 43px">      <p align=center>L</p></td>    <td style="WIDTH: 70px">      <p align=right>$10.00</p></td>	<td>      <p align=right>$<%=Session("7l_total")%></p></td>    </tr>      <!----------------------->  <tr>    <td style="WIDTH: 58px"><%=Session("bm")%> </td>    <td style="WIDTH: 151px">"Baby Doll - Black"</td>    <td style="WIDTH: 43px">      <p align=center>M</p></td>    <td style="WIDTH: 70px">      <p align=right>$10.00</p></td>	<td>      <p align=right>$<%=Session("bm_total")%></p></td>    </tr>
     <!----------------------->  <tr>    <td style="WIDTH: 58px">&nbsp;</td>    <td colspan=3 >SHIPPING - <em><small>U.S. 1st Class Mail (1-2 week delivery time)</em></SMALL></td>    <td>      <p align=right>$3.00</p></td>    </tr>  <!----------------------->  <tr>    <td style="WIDTH: 58px">&nbsp;</td>    <td style="WIDTH: 151px">TOTAL</td>    <td style="WIDTH: 43px">      <p align=center></p></td>    <td style="WIDTH: 70px">      <p align=right></p></td>	<td>      <p align=right>$<%=Session("grand_total")%></p></td>    </tr>  <!----------------------->  </table>    <h2>PERSONAL INFORMATION</h2>  <table>	<tr>		<td>First Name:</td>		<td><%=Session("First Name")%>&nbsp; Last Name:&nbsp; <%=Session("Last Name")%></td>	</tr>	<tr>		<td>Mailing Address 1:</td>		<td>      <%=Session("Address1")%> <br>			</td>	</tr>	<tr>		<td>Mailing Address 2:</td>		<td><%=Session("Address2")%><br>			</td>	</tr>	<tr>		<td>City:</td>		<td><%=Session("City")%>&nbsp;       State: <%=Session("State")%></td>	</tr>	<tr><td>Zip</td><td><%=Session("Zip")%></td></tr>		<tr>		<td>Email Address:</td>		<td><%=Session("email")%><br>			</td>	</tr>	<tr>		<td>Daytime phone:</td>		<td><%=Session("phone")%><br>			</td>	</tr>  </table><%End Sub'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function ChopToWidth(strText, iWidth)	'ChopToWidth = strText	'Exit Function	Dim DEBUG_MODE 	DEBUG_MODE = false	Dim strTemp	Dim iCurrentChar	Dim iTemp	Dim strReturn	Dim x 	'iWidth=20	iCurrentChar = 1	Dim iCount	Dim bNewLineInString		If DEBUG_MODE THEN Response.Write("Length of String = " &len(strText) & "<br>")	If DEBUG_MODE Then Response.Write("<table border=1><tr><td colspan=2>")	If DEBUG_MODE Then Response.Write("<pre>         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6         7         8         9         0<br>")	If DEBUG_MODE Then Response.Write     ("12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890<br>")	If DEBUG_MODE Then Response.Write(Replace(strText,vbCrlF,"*") & "</td></tr>")	While iCurrentChar <= Len(strText)		If DEBUG_MODE Then Response.Write("<tr><td>Begin of Loop - ichar:" & iCurrentChar & "&lt;" & Mid(strText,iCurrentChar,1) & "&gt;" & Asc(Mid(strText,iCurrentChar,1))& "</td><td> " & Mid(strText,iCurrentChar) & "</td>")		'Saves from infinite loop!		x = x + 1		if x > 100 Then 			ChopToWidth = strReturn			Exit Function		End If				' 32 = newline
		' 46 = .		' 13 = space		While  Asc(Mid(strText,iCurrentChar,1)) = 32 _ 			OR Asc(Mid(strText,iCurrentChar,1)) = 46 _ 			OR Asc(Mid(strText,iCurrentChar,1)) = 13  			iCurrentChar = iCurrentChar + 1		Wend		If DEBUG_MODE Then Response.Write("<tr><td>Move ichar - ichar:" & iCurrentChar & "&lt;" & Mid(strText,iCurrentChar,1) & "&gt;" & Asc(Mid(strText,iCurrentChar,1))& "</td><td> " & Mid(strText,iCurrentChar) & "</td>")			strTemp = Mid(strText, iCurrentChar, iWidth)		'If DEBUG_MODE Then Response.Write("<tr><td><b>1st Cut</td><td><b> " & Replace(strTemp,vbCrlF,"*NL*") & "</b></td>")		'If there is a newline in the current line		iTemp = InStr(strTemp, vbcrlf)		If iTemp <> 0 Then			strTemp = Mid(strText,iCurrentChar,iTemp)		'If the last character is NOT a SPACE		ElseIf Len(strTemp) < iWidth Then ' AND bNewLineInString = FALSE Then 'It's the last line in the block			If DEBUG_MODE Then Response.Write("<tr><td colspan=2>last line</td></tr>")						strTemp = strTemp 			iCurrentChar = 1000000000		ElseIf Right(strTemp,1) <> " " Then ' AND (Len(strTemp) = iWidth) Then			iTemp = InStrRev(strTemp," ")			If iTemp = 0 Then 'no spaces 1 word is the whole line				If DEBUG_MODE Then Response.Write("<tr><td colspan=2>one word</td></tr>")				strTemp = strTemp & vbCrlF			Else				If DEBUG_MODE Then Response.Write("<tr><td colspan=2>multi words</td></tr>")				strTemp = Mid(strText,iCurrentChar, iTemp) & vbCrlF			End If		Else			If DEBUG_MODE Then Response.Write("<tr><td colspan=2>else</td></tr>")			strTemp = strTemp & vbCrlF		End If				strReturn = strReturn & strTemp				If DEBUG_MODE Then Response.Write("<tr><td colspan=2>ichar = " & iCurrentChar & "len(strTemp) = " & Len(strTemp)& " </td>")				iCurrentChar = iCurrentChar + Len(Replace(strTemp,vbCrlF,""))		If DEBUG_MODE Then Response.Write("<tr><td>New ichar = " & iCurrentChar & "</td><td bgcolor=black> </td>")		If DEBUG_MODE Then Response.Write("<tr><td bgcolor=black></td><td bgcolor=black> </td>")	Wend	ChopToWidth = strReturn	If DEBUG_MODE Then Response.Write("</table>")End Function'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function Rpad(strText, chrPadding, intLength)		Rpad = right(String(20,chrPadding) & strText, intLength)End Function%></td></tr></table>