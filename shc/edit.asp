<!-- #include file="../include/newtop.txt" --><!-- #include file="../include/libformobjects.inc" --><!-- #include file="../include/huhlink.inc" --><!-- #include file="../include/pcase.inc" --><!-- #include file="../include/hasrights.inc" --><% Dim temp''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function SelectUser()	Dim objDB	Dim objRS	Dim tempSQL	Dim sAction		If HasRights("selectallusers", Session("userlevel")) then		tempSQL = "SELECT userid, login as label " _				& "FROM  user " _ 				& "ORDER BY login "	Else 		tempSQL  = "SELECT userid, login as label " _					& "FROM  user " _					& "WHERE userid = " & Request.Cookies("userid") & " "_					& "ORDER BY login "	End If 	Response.Write("<form method=post action=edituser.asp>")	BuildDropDown "user", tempSQL, ""	Response.Write("<br><br><input type=submit name=action value='Edit User'> ")	Response.Write("</form>")End Function' SelectUser()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function OwnRecords(strTable, strUserID)	Dim objRS	Dim objDB	Dim ownSQL		Set objDB = Server.CreateObject("ADODB.Connection")	objDB.Open DATABASE	ownSQL = "Select count(*)as count from " & strTable & " WHERE userid = " & strUserID	Set objRS = objDB.Execute (ownSQL)		If objRS("count") > 0 Then		OwnRecords = TRUE	Else		OwnRecords = FALSE	End If		objRS.Close	objDB.Close	End Function''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function SelectEvent()	Dim strSQL	Dim strSQL1	Dim strSQL2	Dim strSQL3	Dim sDBName	Dim sAction		If HasRights("selectallevents", Session("userlevel")) then			strSQL = "SELECT eventid, date, eventid&': '&date&' - '&event.name as label " & _				 "FROM   event " & _				 " ORDER BY DATE DESC"				 ' "WHERE  event.date > #" & Date & "#" & _	Else 		strSQL = " SELECT eventid, date, eventid&': '&date&' - '&event.name as label " & _				 " FROM   event " & _				 " WHERE    (event.userid = " & Session("userid") & _				 " OR    event.bandid IN (select bandid from band where userid = " & Session("userid") & " ) " & _				 " OR    event.venueid IN (select venueid from venue where userid = " & Session("userid") & " ) " & _		 		 " OR    event.instructorid IN (select instructorid from instructor where userid = " & Session("userid")  &  " )) " & _				 " ORDER BY DATE DESC " 				'" WHERE  event.date > #" & Date& "#" & _				 	End If 		Response.Write("<form method=post action=editevent.asp>")	BuildDropDown "event", strSQL, ""	Response.Write("<br><input type=submit name=action value='Edit Event'> ")	If HasRights("deleteevent", Session("userlevel")) Then		Response.Write("<input type=submit name=action value='Delete Event'> ")	End If	Response.Write("</form>")End Function' SelectEvent()'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function SelectFromTable(strTable)	Dim strSQL	Dim sAction	Dim strTableLabel		strTableLabel = PCase(strTable)		Response.Write("<tr>")	Response.Write("<td bgcolor = " & sRowColor & ">"&strTableLabel&"</td>")	Response.Write("<td>")	If (OwnRecords(strTable, Session("userid")) = TRUE) or HasRights("viewallVBI",(Session("userlevel"))) Then		If HasRights("viewallVBI",Session("userlevel")) then				strSQL = "SELECT name as label, "&strTable&"ID  FROM  "&strTable&" ORDER BY name"		Else 			strSQL = "SELECT name as label, "&strTable&"ID FROM  "&strTable&" WHERE userid = " & Session("userid") & " ORDER BY name"		End If 				Response.Write("<form method=post action=editrecord.asp?table="&strTable&">")		BuildDropDown strTable, strSQL, ""		Response.Write("<br><input type=submit name=action value='Edit "&strTableLabel&"'> ")			If HasRights("deleteVBI",Session("userlevel")) Then			Response.Write("<input type=submit name=action value='Delete "&strTableLabel&"'> ")		End If				Response.Write("</form>")	Else		Response.Write("You do not represent any "&strTable&"s.")	End If	Response.Write("</td><td>")	Response.Write("<a href=editrecord.asp?table="&strTable&">New "&strTableLabel&" </a>")	Response.Write("</td></tr>")End Function' SelectFromTable(strTable)'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function SelectIssue()	Dim strSQL	Dim sAction	Dim strTableLabel		dim strTable		strTable = "Issue"		strTableLabel = PCase(strTable)		Response.Write("<tr>")	Response.Write("<td bgcolor = " & sRowColor & ">"&strTableLabel&"</td>")	Response.Write("<td>")	If (OwnRecords(strTable, Session("userid")) = TRUE) or HasRights("viewallusers",(Session("userlevel"))) Then		If HasRights("viewallusers",Session("userlevel")) then				strSQL = "SELECT name as label, "&strTable&"ID  FROM  "&strTable&" ORDER BY name"		Else 			strSQL = "SELECT name as label, "&strTable&"ID  FROM  "&strTable&" WHERE userid = " & Session("userid") & " ORDER BY name"		End If 				Response.Write("<form method=get action=issue.asp>")		BuildDropDown strTable, strSQL, ""		Response.Write("<br><input type=submit name=action value='Edit "&strTableLabel&"'> ")			If HasRights("deleteusers",Session("userlevel")) Then			Response.Write("<input type=submit name=action value='Delete "&strTableLabel&"'> ")		End If				Response.Write("</form>")	Else		Response.Write("You do not represent any "&strTable&"s.")	End If	Response.Write("</td><td>")	Response.Write("<a href=issue.asp>New Issue </a>")	Response.Write("</td></tr>")End Function' SelectFromTable(strTable)''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function SelectNews()	Dim strSQL	'Dim sDBName	Dim sAction		Response.Write("<tr>")	Response.Write("<td bgcolor = " & sRowColor & ">News</td>")	Response.Write("<td>")			If HasRights("viewnews",Session("userlevel")) then			strSQL = "SELECT name as label, NewsID  FROM  News ORDER BY name"	Else 		strSQL = "SELECT name as label, NewsID  FROM  News WHERE userid = " & Session("userid") & " ORDER BY name"	End If 		Response.Write("<form method=post action=editnews.asp>")	BuildDropDown "news", strSQL, ""	Response.Write("<br><input type=submit name=action value='Edit News'> ")	If HasRights("deletenews",Session("userlevel")) Then		Response.Write("<input type=submit name=action value='Delete News'> ")	End If		'Response.Write("</blockquote>") 		Response.Write("</form>")	'Response.Write("<hr>")	Response.Write("</td><td>")	Response.Write("<a href=editnews.asp>New News</a>")	Response.Write("</td></tr>")End Function' SelectNews()''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''If session("login") = "" Then	Response.Write ("<h1 align=center>Welcome to SwingHomeChicago.com's Edit Page!</h1><p>")	Response.Write ("To Add and Event, Band, or Venue, you must be registered with SwingHomeChicago.com. ")	Response.Write ("Please log in to edit records, or create a new account.<p>")	Response.Write ("<a href=edituser.asp>Create my user account!</a> It's FREE")Else	Response.Write("<h1>Edit/Add Records</h1>")	Response.Write("Welcome to the Edit Page. If you are a representative "&huhlink("rep","")&" any band/instructor/venue, they will show up in the table below.<p>")	Response.Write("Please choose one to edit, or add a new record.<br>")	Select Case Session("userlevel")		Case ADMIN			Response.Write("<font color=red> YOU ARE AN ADMINISTRATOR </font><p>")		Case PRIVUSER			Response.Write("<font color=red> YOU ARE A SUPER USER </font><p>")	End Select		Response.Write("<table width= " & TABLEWIDTH & " border=0>")	Response.Write("<tr>")	Response.Write("<th bgcolor = " & sRowColor & ">Category</th>")	Response.Write("<th bgcolor = " & sRowColor & ">Edit Record</th>")	Response.Write("<th bgcolor = " & sRowColor & ">New Record</th>")	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	'USER		Response.Write("<tr>")	Response.Write("<td bgcolor = " & sRowColor & ">User</td>")	Response.Write("<td>")	If HasRights("viewallusers",Session("userlevel")) Then		SelectUser()	Else		Response.Write("<a href=edituser.asp?userid=" & Session("userid") & ">Edit My Profile</a>")	End If	Response.Write("</td><td>")	Response.Write("<a href=edituser.asp>New User </a>")	Response.Write("</td></tr>")	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	'EVENTS	Response.Write("<tr>")	Response.Write("<td bgcolor = " & sRowColor & ">Events</td>")	Response.Write("<td valign=""middle"">")		If OwnRecords("Event", Session("userid")) = TRUE or _	   OwnRecords("Band", Session("userid")) = TRUE or _	   OwnRecords("Venue", Session("userid")) = TRUE or _	   OwnRecords("Instructor", Session("userid")) = TRUE or _	   (HasRights("selectallevents",Session("userlevel"))) Then			SelectEvent()	Else		Response.Write("You do not represent any band,instructor, or venue in an event.")	End If	Response.Write("</td><td>")	Response.Write("<a href=editevent.asp?action=New>New Event <br></a>")	Response.Write("</td></tr>")	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	'BAND	SelectFromTable("band")	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	'VENUE	SelectFromTable("venue")	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	'INSTRUCTOR	SelectFromTable("instructor")	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	'NEWS	If HasRights("viewnews",Session("userlevel")) Then		SelectNews()		'SelectIssue()	End If	''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''	Response.Write("</table>")End If%><!-- #include file="../include/newbottom.txt" --> 