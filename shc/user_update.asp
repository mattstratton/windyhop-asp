<%Option ExplicitResponse.Buffer = TRUE%><!-- #include file="../include/globalc.inc" --><%Sub ReadUBBFile(ubbID)	'	Field 1: UserName<BR>	'	Field 2: Password<BR'>'	Field 3: Email address<BR>'	Field 4: URL<BR>'	Field 5: Permissions (Any or none of Write (gives permission to post) and Admin (admin privileges), possibly followed by an &amp; and a list of private forums user is allowed to access (&amp; separated)).<BR>'	Field 6: Occupation<BR>'	Field 7: Location<BR>'	Field 8: Total Posts<BR>'	Field 9: Status (Administrator, Moderator, etc..)<BR>'	Field 10: Interests<BR>'	Field 11: Date Registered<BR>'	Field 12: Allow email address to be viewed? Valid values are "yes" and "no".<BR>'	Field 13: Signature<BR>'	Field 14: ICQ number<BR>'	Field 15: Allow BB operators to email in mass mailing? Valid values are "yes" and "no".'   Field 16: YahooID	Dim bolFileExists	serverpath=server.mappath(".") & "\..\..\data\Members\"	'Response.Write("ServerPath = " & serverpath & "<br>")	'DEFAULT USER LEVELS 	'sMsgCount = "0" 	'sMemberStatus = "Junior Member" 	sUBBperm = "Write" 	'ddate = Date()    dim fso, f	set fso = CreateObject("Scripting.FileSystemObject")	'If a seperate user file exists, then it's an update!	bolFileExists = fso.FileExists(serverpath & right("00000000" & ubbID, 8) & ".cgi") 	If bolFileExists Then		set f = fso.OpenTextFile( serverpath & right("00000000" & ubbID, 8) & ".cgi", 1)		'	Field 1: UserName<BR>			f.SkipLine		'	Field 2: Password<BR'>	 	f.SkipLine		'	Field 3: Email address<BR>	 	f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 4: URL<BR>		sUBBurl = f.Readline		If f.AtEndOfStream Then Exit Sub		'	Field 5: Permissions (Any or none of Write (gives permission to post) and Admin (admin privileges), possibly followed by an &amp; and a list of private forums user is allowed to access (&amp; separated)).<BR>	 	sUBBperm = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 6: Occupation<BR>	 	sUBBoccupation = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 7: Location<BR>	 	sUBBlocation = f.ReadLine		If f.AtEndOfStream Then Exit Sub	 	'Response.Write("Location = " & sUBBlocation & "<br>")		'	Field 8: Total Posts<BR>	 	sUBBtotalposts = f.ReadLine	 	If f.AtEndOfStream Then Exit Sub		'	Field 9: Status (Administrator, Moderator, etc..)<BR>		sUBBStatus = f.Readline		If f.AtEndOfStream Then Exit Sub	 	'	Field 10: Interests<BR>	 	sUBBinterests = f.ReadLine	 	If f.AtEndOfStream Then Exit Sub		'	Field 11: Date Registered<BR>	 	sUBBdateregistered = f.ReadLine	 	If f.AtEndOfStream Then Exit Sub		'	Field 12: Allow email address to be viewed? Valid values are "yes" and "no".<BR>	 	bShowEmail = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 13: Signature<BR>		sUBBsignature = f.ReadLine		If f.AtEndOfStream Then Exit Sub		sUBBsignature = Replace(sUBBsignature,"<br>", vbCrlF)		'Field 14: ICQ number<BR>	 	sUBBicq = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 15: Allow BB operators to email in mass mailing? Valid values are "yes" and "no".	 	sUBBmassemail = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 16	 	f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 17		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 18		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 19		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 20		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 21		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 22		sUBBPrune = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 23		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 24		sUBBEdit = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 25		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 26		sUBBRatings = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 27		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 28		sUBBPM = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 29		sUBBNotify = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 30		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 31		sUBBLastPost = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 32		sUBBUserTitle = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 33		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 34		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 35		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 36		f.SkipLine		If f.AtEndOfStream Then Exit Sub		'	Field 37		sUBBPollBan = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 38		sUBBAvatarPath = f.ReadLine		If f.AtEndOfStream Then Exit Sub		'	Field 39		sUBBAvatarLock = f.ReadLine		If f.AtEndOfStream Then Exit Sub			 	f.Close 	End If	Set fso = Nothing	Set f = Nothing	End SubSub WriteUBBUserFile()	Dim fso	Dim tf		set fso = CreateObject("Scripting.FileSystemObject")		If sUbbPerm = "" Then		sUBBPerm = "Write"	End If		If sUBBStatus = "" Then		sUBBStatus = "Junior Member"	End If	set tf = fso.CreateTextFile(serverpath & right("00000000" & lngUserID, 8) & ".cgi", true)	tf.writeline "" & strLogin				'Line 1 	tf.writeline "" & strPassword			'Line 2 	tf.writeline "" & strEmail				'Line 3 	tf.writeline ""	& sUBBurl				'Line 4 	tf.writeline sUbbPerm					'Line 5 	tf.writeline "" & sUBBoccupation		'Line 6 	tf.writeline ""	& sUBBlocation		'Line 7 	tf.writeline ""	& sUBBtotalposts				'Line 8 	tf.writeline ""	& sUBBStatus					'Line 9 	tf.writeline ""	& sUBBInterests				'Line 10 	tf.writeline Month(dCreationDate) & "-" & Day(dCreationDate) & "-" & Year(dCreationDate)	'Line 11 	tf.writeline ""	& bShowEmail					'Line 12 	tf.writeline ""	& sUBBsignature				'Line 13 	tf.writeline ""	& sUBBicq					'Line 14 	tf.writeline ""	& sUBBmassEmail				'Line 15 	tf.writeline ""	& strLogin					'Line 16 - display name	tf.writeline VbCrLf						'Line 17 - Custom 1	tf.writeline VbCrLf						'Line 18 - Custom 2	tf.writeline VbCrLf						'Line 19 - Custom 3	tf.writeline VbCrLf						'Line 20 - Custom 4	tf.writeline VbCrLf						'Line 21 - Picture URL	tf.writeline ""	& sUBBPrune					'Line 22 - Days Prune	tf.writeline VbCrLf						'Line 23 - AIM ID	tf.writeline ""	& sUBBEdit					'Line 24 - Last Edit Info	tf.writeline VbCrLf						'Line 25 - Profile Locked	tf.writeline ""	& sUBBRatings				'Line 26 - Allow User Ratings	tf.writeline VbCrLf						'Line 27 - Awaiting Queue	tf.writeline ""	& sUBBPM						'Line 28 - Allow PM's	tf.writeline ""	& sUBBNotify					'Line 29 - Email Notify on PM	tf.writeline VbCrLf						'Line 30 - Allow Admin to Pm	tf.writeline ""	& sUBBLastPost				'Line 31 - Last Post Info	tf.writeline ""	& sUBBUserTitle				'Line 32 - Admin-assigned user title	tf.writeline VbCrLf						'Line 33 - Birthdate	tf.writeline VbCrLf						'Line 34 - Parental Email	tf.writeline VbCrLf						'Line 35 - Registration IP	tf.writeline VbCrLf						'Line 36 - Invisible?	tf.writeline ""	& sUBBPollBan				'Line 37 - BanPoll	tf.writeline ""	& sUBBAvatarPath				'Line 38 - Rel or abs avatar URL	tf.writeline ""	& sUBBAvatarLock				'Line 39 - Lock user avatar 	tf.close 		Set tf = Nothing	Set fso = NothingEnd SubDim objDBDim objRSDim sDBNameDim sActionDim sErrorDim lngUseridDim strLoginDim strEmailDim strPasswordDim strPassword2Dim strFirstnameDim strLastnameDim strPhoneDim strZipDim lngUserlevelDim lngBandIDFav1Dim lngVenueIDFav1Dim strEmailList1Dim strEmailList2Dim serverpathDim sUBBurlDim sUBBpermDim sUBBStatusDim sUBBoccupationDim sUBBlocationDim sUBBtotalpostsDim sUBBdateregisteredDim sUBBsignatureDim sUBBmassemailDim sUBBicqDim sUBByahooDim sUBBinterestsDim dCreationDateDim bShowEmailDim sUBBAvatarLockDim sUBBAvatarPathDim sUBBPollBanDim sUBBUserTitleDim sUBBLastPostDim sUBBNotifyDim sUBBPMDim sUBBRatingsDim sUBBEditDim sUBBPruneDim localUserIDDim tempDim strBodyDim bolNewPasswordSet objDB = Server.CreateObject("ADODB.Connection")objDB.Open DATABASESet objRS = objDB.Execute("select * from User")Do While Not objRS.EOF		lngUserid = objRS("Userid")		strLogin = objRS("Login")		strEmail = objRS("Email")		strPassword = objRS("Password")		strFirstname = objRS("Firstname")		strLastname = objRS("Lastname")		strPhone = objRS("Phone")		strZip = objRS("Zip")		lngUserlevel = objRS("userlevel")		lngBandIDFav1 = objRS("bandIDFav1")		lngVenueIDFav1 = objRS("venueIDFav1")		strEmailList1 = objRS("emailList1")		strEmailList2 = objRS("emailList2")		dCreationDate = objRS("CreationDate")		sUBBoccupation = objRS("occupation")		sUBBlocation = objRS("location")		sUBBsignature = objRS("signature")		sUBBicq = objRS("ICQ")		sUBByahoo = objRS("yahoo")		sUBBinterests = objRS("interests")				ReadUBBFile(lngUserID)			Dim objDBUBB			Dim objRSUBB			Dim SQLUBB			Dim fso			Dim f			Dim sMemberStatus			Dim sPerms			Dim ddate			Dim tf			Dim tfEmailFile			Dim tfMemberList			'Dim serverpath			Dim bolIsUpdate			serverpath=server.mappath(".") & "\..\..\data\Members\"			WriteUBBUserFile()			Response.Write(objRS("Login"))			Response.Write("<br>")			Response.Flush					objRS.MoveNextLoop	objRS.CloseobjDB.CloseSet objRS = NothingSet objDB = Nothing%>