	<!--	This page enables the CSS style of viewing workshops and lessons.		 	Hrefs to call the different options are commented out, but can be viewed for reference.	--><%  ' Option Explicit %><!-- #include file="../include/newtop.txt" --> <!-- #include file="../include/libformobjects.inc"--><!-- #include file="../include/geteventset.inc"--><!-- #include file="../include/abletoeditanevent.inc"-->	<% Dim intThisMonthDim intThisYearDim datTodayDim datLastWeekDim datNextWeekDim intLastMonthDim intNextMonthDim intThisDayDim intThisWeekDayDim strMonthNameDim strWeekDayNameDim datFirstDayDim intFirstWeekDayDim intLastDayDim intPrintDayDim intIsFirstDim intNewMonthDim strTimeDim intEventIdDim counterDim datCounterDayDim datThisWeekDim datThisWeek7Dim datToday7Dim	datLastWeek7 Dim	datNextWeek7Dim datUpcoming Dim	datUpcoming28Dim datUpcoming56 Dim strDispStyleDim seeEventNotesDim strNumOfWeeksDim strPreReq'These are variables used by Detail View. They may overlap and there may be an existing variable I should use,'but I don't care -MattDim strEventTypeDim strEventNameDim strEventDateDim strEventVenueDim strEventVenueIDDim strEventBandDim strEventBandIDDim strEventInstructorDim strEventInstructorIDDim strEventLessontimeDim strEventShowtimeDim strEventEndtimeDim strEventPriceDim strEventAgeDim strEventNote1Dim strEventNote2''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sub GetDates()	intThisMonth = Request.QueryString("month")	intThisYear = Request.QueryString("year") 	intThisDay = Request.QueryString("day")	datToday = Date()                         'today's date	'datToday = "01/04/00"	If IsEmpty(intThisYear) Then		intThisYear = Year(datToday)              'the current year	End If	If IsEmpty(intThisMonth) Then		intThisMonth = Month(datToday)            'the current month	End If		If IsEmpty(intThisDay) Then		intThisDay = Day(datToday)					'the current day	End If		If intThisMonth = 1 Then		intLastMonth = 12	Else		intLastMonth = intThisMonth - 1	End If	If intThisMonth = 12 Then		intNextMonth = 1	Else		intNextMonth = intThisMonth + 1	End If		datToday = DateSerial(intThisYear, intThisMonth, intThisDay)	datThisWeek = datToday	datLastWeek = DateAdd("d",-7,datThisWeek)	datNextWeek = DateAdd("d",7,datThisWeek)	datUpcoming = DateAdd("d",14,datThisWeek)		' now find the date for the Monday of this week used in This Week link -- cww	do While Weekday(datThisWeek) <> Weekday(vbMonday)		datThisWeek = DateAdd("d",-1,datThisWeek)	Loop	datThisWeek7 = DateAdd("d",7,datThisWeek)	' now find the date for the previous Monday used in Last Week link -- cww	do While Weekday(datLastWeek) <> Weekday(vbMonday)		datLastWeek = DateAdd("d",-1,datLastWeek)	Loop	datLastWeek7 = DateAdd("d",7,datLastWeek)	' now find the date for the following Monday used in Next Week link -- cww	do While Weekday(datNextWeek) <> Weekday(vbMonday)		datNextWeek = DateAdd("d",-1,datNextWeek)	Loop 	datNextWeek7 = DateAdd("d",7,datNextWeek)	' now find the date for the Monday used in the Upcoming link -- cww	do While Weekday(datUpcoming) <> Weekday(vbMonday)		datUpcoming = DateAdd("d",-1,datUpcoming)	Loop	datUpcoming28 = DateAdd("d",28,datUpcoming)	datUpcoming56 = DateAdd("d",56,datUpcoming)				intThisDay = Day(datToday)                'the current day	intThisWeekDay = Weekday(datToday)	strMonthName = MonthName(intThisMonth)    'the name of the current month		'now get the name of the current day	strWeekDayName = WeekDayName(WeekDay(datToday), False, vbSunday)	'find the first and last days of this month	' Note from Matt - The strStyle code is placed here, because it is required in the subroutine' that must come before the GetDefaults() and GetOptions() subs	strStyle = Request.QueryString("style")	If strStyle = "" Then		strStyle = "month"	End If		If strStyle = "month" Then		datFirstDay = DateSerial(intThisYear, intThisMonth, 1)		intPrintDay = 1	Else		datFirstDay = DateAdd("d",-(intThisWeekDay - 1),datToday)		intPrintDay = Day(datFirstDay)	End If		intFirstWeekDay = WeekDay(datFirstDay, vbSunday)		If strStyle = "week" Then		intThisMonth = intThisMonth - 1	End If		Select Case intThisMonth	Case 9,4,6,11		intLastDay = 30	Case 2		If intThisYear = 2000 Then			intLastDay = 29		Else			intLastDay = 28		End If	Case Else		intLastday = 31	End Select	End Sub	'GetDates''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''%><!-- the following JavaScript function creates the window status messages to complete the SHC/CSS mask -Clint Wenk --><script language="JavaScript">browser = (((navigator.appName == "Netscape") && (parseInt(navigator.appVersion) >= 3 )) || ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 3 )))if ( browser) {imgoff = new MakeArray(1)imgon = new MakeArray(1)iconpict = new MakeArray(1)clickit = new MakeArray(1)windowstatus = new MakeArray(14)imgoff[1].src = "bands_button.gif"imgon[1].src = "bands_button_b.gif"iconpict[1].src = ""clickit[1].src = "bands_button_c.gif"windowstatus[0] = ""windowstatus[1] = "See events for this week"windowstatus[2] = "See next weeks events"windowstatus[3] = "See upcoming events"windowstatus[4] = "See upcoming workshops"windowstatus[5] = "See Chicagoland Venues"windowstatus[6] = "See a listing of Swing, Rockabilly and Big Bands"windowstatus[7] = "See our Instructors' Listing"windowstatus[8] = "Message of the Day.  Where we tell you what going on with Chicago Swing Scene."windowstatus[9] = "Our Links Page"windowstatus[10] = "Band Detail"windowstatus[11] = "Venue Detail"windowstatus[12] = "Instructor Detail"windowstatus[13] = "Lessons"}function MakeArray(n) {this.length = nfor (var i = 0; i<=n; i++) {this[i] = new Image()}return this}function msover1(num) {if ( browser) {window.status = windowstatus[num]}}function msout1(num) {if ( browser) {window.status = windowstatus[num]}}// --></script></head><body><%getDates()  datBeginDate = Request.QueryString("BeginDate")  datEndDate = Request.QueryString("EndDate")  strDispStyle = Request.QueryString("style")  seeEventNotes = Request.QueryString("Evnotes")		  If datBeginDate = "" OR datBeginDate = " " Then 'if no begin date passed as part of URL default to this week	 datBeginDate = datThisWeek     datEndDate = datUpcoming56   End If		   %><table width=600 border=0 align="left">		<tr>  <!-- Headline, formerly css image -->		<td>			<% 			If strDispStyle = "workshops" Then				Response.write("<H1>WORKSHOPS</h1>")			Elseif strDispStyle = "lessons" Then				Response.write("<H1>LESSONS</h1>")			END if						%>		</td>	</tr>		<% 		If strDispStyle = "workshops" Then			' get the event set with only workshops -cww			getEventSet "","","","","","",YES,datBeginDate,datEndDate,APPROVED,""		Elseif strDispStyle = "lessons" Then			' get the event set with only lessons -cww			getEventSet "","","",YES,"","","",datBeginDate,datEndDate,APPROVED,""		Else			' get the event set with show/DJ's only -cww			getEventSet "","","","",YES,"","",datBeginDate,datEndDate,APPROVED,""		END if 		   'GetEventSet "","","",YES,YES,YES,YES,BEGINTIME,ENDTIME,APPROVED,intEventID		%>	<tr>  <!-- Lessons text -->		<td>			<%			If objRSEvent.EOF Then ' if the event set is empty display an appropriate message ELSE display text indicating what is being displayed.				If strDispStyle = "workshops" Then					Response.write("There are no upcoming workshops at this time.")					Response.write("<BR>")					Response.write("<p><a href=eventsWrkshpsLessons.asp?style=lessons&evnotes=y>Go to Lessons</p></a>")				Elseif strDispStyle = "lessons" Then					Response.write("There are no upcoming class begin dates at this time.")					Response.write("<BR>")					Response.write("<p><a href=eventsWrkshpsLessons.asp?style=workshops&evnotes=y>Go to Workshops</p></a>")				END if			Else 				If strDispStyle = "workshops" Then					Response.write("Below is a list of upcoming Chicagoland workshops.")					Response.write("<BR>")					Response.write("<p><a class=small href=eventsWrkshpsLessons.asp?style=lessons&evnotes=y>Go to Lessons</p></a>")				Elseif strDispStyle = "lessons" Then					Response.write("Below is a list of upcoming class begin dates for the Chicagoland area.")					Response.write("<BR>")					Response.write("<p><a class=small href=eventsWrkshpsLessons.asp?style=workshops&evnotes=y>Go to Workshops</a></p>")				END if						End If			%>			<BR>						<!-- Hrefs from old CSS for reference -->			<!-- <CENTER><P><SMALL><NOBR> --><!-- problem will be that the url is direct to localhost --cww  -->				<!--[ <A TARGET="Main" HREF="http://www.swinghomechicago.com/eventsCSS.asp?BeginDate=<% = datThisWeek %>&EndDate=<% = datThisWeek7 %>" onMouseOver="msover1(1) ; return true" onMouseOut="msout1(0)">This Week</A> |				<A TARGET="Main" HREF="http://www.swinghomechicago.com/eventsCSS.asp?BeginDate=<% = datNextWeek %>&EndDate=<% = datNextWeek7 %>" onMouseOver="msover1(2) ; return true" onMouseOut="msout1(0)">Next Week</A> |				<A TARGET="Main" HREF="http://www.swinghomechicago.com/eventsCSS.asp?BeginDate=<% = datUpcoming %>&EndDate=<% = datUpcoming28 %>" onMouseOver="msover1(3) ; return true" onMouseOut="msout1(0)">Upcoming</A> |				<A TARGET="Main" HREF="http://www.swinghomechicago.com/eventsCSS.asp?BeginDate=<% = datThisWeek %>&EndDate=<% = datUpcoming28 %>&style=workshops&Evnotes=y" onMouseOver="msover1(4) ; return true" onMouseOut="msout1(0)">Workshops</A> |				<A TARGET="Main" HREF="http://www.swinghomechicago.com/eventsCSS.asp?BeginDate=<% = datThisWeek %>&EndDate=<% = datUpcoming56 %>&style=lessons&Evnotes=y" onMouseOver="msover1(13) ; return true" onMouseOut="msout1(0)">Lessons</A> |				<A TARGET="Main" HREF="http://www.stormloader.com/chicagoswing/shc/venues.html" onMouseOver="msover1(5) ; return true" onMouseOut="msout1(0)">Venues</A> |				<A TARGET="Main" HREF="http://www.stormloader.com/chicagoswing/shc/bands.html" onMouseOver="msover1(6) ; return true" onMouseOut="msout1(0)">Bands</A> |				<A TARGET="Main" HREF="http://www.stormloader.com/chicagoswing/shc/instructors.html" onMouseOver="msover1(7) ; return true" onMouseOut="msout1(0)">Instructors</A> |			  	<A TARGET="Main" HREF="http://www.stormloader.com/chicagoswing/shc/motd.html" onMouseOver="msover1(8) ; return true" onMouseOut="msout1(0)">Motd</A> |				<A TARGET="Main" HREF="http://www.stormloader.com/chicagoswing/shc/links.html" onMouseOver="msover1(9) ; return true" onMouseOut="msout1(0)">Links</A> ] -->								<!-- comment this block out for production.  This is a test block for localhost testing of links only -Clint Wenk 				[ <A TARGET="Main" HREF="eventsCSS.asp?BeginDate=<% = datThisWeek %>&EndDate=<% = datThisWeek7 %>" onMouseOver="msover1(1) ; return true" onMouseOut="msout1(0)">This Week</A> |				<A TARGET="Main" HREF="eventsCSS.asp?BeginDate=<% = datNextWeek %>&EndDate=<% = datNextWeek7 %>" onMouseOver="msover1(2) ; return true" onMouseOut="msout1(0)">Next Week</A> |				<A TARGET="Main" HREF="eventsCSS.asp?BeginDate=<% = datUpcoming %>&EndDate=<% = datUpcoming28 %>" onMouseOver="msover1(3) ; return true" onMouseOut="msout1(0)">Upcoming</A> |				<A TARGET="Main" HREF="eventsCSS.asp?BeginDate=<% = datThisWeek %>&EndDate=<% = datUpcoming28 %>&style=workshops&Evnotes=y" onMouseOver="msover1(4) ; return true" onMouseOut="msout1(0)">Workshops</A> |				<A TARGET="Main" HREF="eventsCSS.asp?BeginDate=<% = datThisWeek %>&EndDate=<% = datUpcoming56 %>&style=lessons&Evnotes=y" onMouseOver="msover1(13) ; return true" onMouseOut="msout1(0)">Lessons</A> |				<A TARGET="Main" HREF="venues.html" onMouseOver="msover1(5) ; return true" onMouseOut="msout1(0)">Venues</A> |				<A TARGET="Main" HREF="bands.html" onMouseOver="msover1(6) ; return true" onMouseOut="msout1(0)">Bands</A> |				<A TARGET="Main" HREF="instructors.html" onMouseOver="msover1(7) ; return true" onMouseOut="msout1(0)">Instructors</A> |			  	<A TARGET="Main" HREF="motd.html" onMouseOver="msover1(8) ; return true" onMouseOut="msout1(0)">Motd</A> |				<A TARGET="Main" HREF="links.html" onMouseOver="msover1(9) ; return true" onMouseOut="msout1(0)">Links</A> ]				 comment this block out for production.  This is a test block for localhost testing of links only -Clint Wenk -->			<!-- </NOBR></SMALL></P></CENTER> 			<CENTER><P><SMALL>			<A TARGET="_top" HREF="http://www.stormloader.com/chicagoswing">http://www.stormloader.com/chicagoswing</A><BR>			<A HREF="mailto:chicago-swing-scene@egroups.com">mailto:chicago-swing-scene@egroups.com</A>			</SMALL></P></CENTER> 			<HR class=mainclr> -->		</td>	</tr>		<tr>		<td>		<CENTER><TABLE border = 0 Valign = "top">				<% 		datCounterDay = datBeginDate				intIsFirst = 0		intNewMonth = 0		Do While DateValue(datCounterDay) < DateValue(datEndDate) 		%>									<% 									If Not objRSEvent.EOF Then 				Do While DateValue(objRSEvent("date")) = DateValue(datCounterDay)									If (strDispStyle = "workshops") or (strDispStyle = "lessons") Then						If (intIsFirst = 0) Then							WeekDayNm = WeekDayName(WeekDay(datCounterDay), False, vbSunday)							MnthNm = MonthName(Month(datCounterDay))							DateNbr = Day(datCounterDay)							Response.write("<TR>")							Response.write("<th colspan=3 ALIGN=center VALIGN=top> <font class=CSSHeader>")							Response.write(WeekDayNm)							Response.write(", ")							Response.write(MnthNm)							Response.write(" ")							Response.write(DateNbr)							Response.write("</font><hr width = 700 class=mainclr></TH>")							Response.write("</TR>")						End if					End if									%> 			<%	' Tell the user what month it is, and if a month change occurs display the Month				If (intNewMonth = 0) and (strDispStyle <> "workshops") and (strDispStyle <> "lessons") Then					MnthNm = MonthName(Month(datCounterDay))					Response.write("<TR>")					Response.write("<Center><font class=CSSHeader>")					Response.write(MnthNm)					Response.write("</Center></font>")					Response.write("</TR>")								End if			%>					<tr>			<% 				If (strDispStyle <> "workshops") and (strDispStyle <> "lessons") Then					If (intIsFirst = 0) Then						WeekDayNm = WeekDayName(WeekDay(datCounterDay), False, vbSunday)						DateNbr = Day(datCounterDay)						'HTML to print the day name						Response.write("<TD valign =top>")						Response.write(WeekDayNm)						Response.write("</TD>")						'HTML to print the date in gold						Response.write("<TD valign =top>")						Response.write("<font class = accent>")						Response.write(DateNbr)									Response.write("</font>")						Response.write("</TD>")						Else 'Need to maintain the look of the table for additional records on each day						'HTML to print the space for the day name						Response.write("<TD valign =top>")						Response.write("</TD>")						'HTML to print the space that would hold date in gold						Response.write("<TD valign =top>")						Response.write("</TD>")					End if				End if							If (strDispStyle = "workshops") or (strDispStyle = "lessons") Then					Response.write("<td valign=top width=500 >")				Else					Response.write("<td valign=top >")				End if				'Inside the 3rd column table detail -cww					If isNull(objRSEvent("BandID")) Then						BandTest = False					Else						BandTest = (CStr(objRSEvent("BandID")) <> DEFAULT)					End if										Response.write("<font class=CSSEvent>")					Response.write(objRSEvent("EventName")) 					Response.write("</font><BR>")										%>					<font class=CSSText>					<%					If (strDispStyle = "workshops") or (strDispStyle = "lessons") Then						Response.Write("Presented by:   ")						If objRSEvent("InstructorID") <> "" AND objRSEvent("InstructorID") <> " " Then 					%>							<a href = "view.asp?table=instructor&id=<% = objRSEvent("InstructorID") %>" onMouseOver="msover1(12) ; return true" onMouseOut="msout1(0)">							<%							Response.Write(objRSEvent("InstructorName"))							Response.Write("<BR>")							%>							</a>					<% 						Else 							Response.Write("<font class=mainclr>")							Response.write(objRSEvent("InstructorName")) 							Response.write("</font><BR>")						End If 					End If ' (strDispStyle = "workshops")										If (seeEventNotes = "y") Then						Response.Write(objRSEvent("eventnote1"))						Response.Write("<BR>")					End If					If (seeEventNotes = "y") Then						Response.Write(objRSEvent("eventnote2"))						Response.Write("<BR>")					End If					%>					</font>				</td>				<td valign = "top">				   <font class=CSSText>					<% 					If objRSEvent("VenueID") <> "" AND objRSEvent("VenueID") <> " " Then 					%>						Held at: <BR>						<a href = "view.asp?table=venue&id=<% = objRSEvent("VenueID") %>" onMouseOver="msover1(11) ; return true" onMouseOut="msout1(0)">					   	<%						Response.Write(objRSEvent("VenueName"))						%>						</a>					<% 					Else						Response.write("Held at: <BR>") 						Response.write(objRSEvent("VenueName")) 					End If 					%>					</font>				</td>				<td valign = "top">					<font class=CSSText>					<% 					Select Case objRSEvent("EventType") ' Select block determines lesson and show times to be populated in 3rd column						Case WORKSHOP							Response.Write("Workshop:  ")							strTime = objRSEvent("lessontime")							strEndTime = objRSEvent("EndTime")							Response.Write(strTime)							If objRSEvent("EndTime") <> "" AND objRSEvent("EndTime") <> " " Then								Response.Write(" - ")								Response.Write(strEndTime)							End if						   	Response.Write("<br>")						Case LESSON							Response.Write("Lesson:  ")							strTime = objRSEvent("lessontime")							strEndTime = objRSEvent("EndTime")							strNumOfWeeks = objRSEvent("NoOfWeeks")							strPreReq = objRSEvent("PreReq")							Response.Write(strTime)							If objRSEvent("EndTime") <> "" AND objRSEvent("EndTime") <> " " Then								Response.Write(" - ")								Response.Write(strEndTime)							End if							Response.Write("<br>")							Response.Write(strNumOfWeeks)							Response.Write(" weeks")							Response.Write("<br>")							Response.Write("Prerequisite: ")							Response.Write(strPreReq)							Response.Write("<br>")						Case SHOWDJ							If objRSEvent("lessontime") <> "" AND objRSEvent("lessontime") <> " " Then								Response.Write("Lesson:  ")								strTime = objRSEvent("lessontime")								Response.Write(strTime)								Response.Write("<br>")							End If							Response.Write("Show:  ")							strTime = objRSEvent("showtime")							Response.Write(strTime)							Response.Write("<br>")						Case OTHER							If objRSEvent("lessontime") <> "" AND objRSEvent("lessontime") <> " " Then								Response.Write("Lesson:  ")								strTime = objRSEvent("lessontime")								Response.Write(strTime)								Response.Write("<br>")							End If							Response.Write("Show:  ")							strTime = objRSEvent("showtime")							Response.Write(strTime)						   	Response.Write("<br>")												End Select		   						   										If objRSEvent("Price") <> "" AND objRSEvent("Price") <> " " AND objRSEvent("Price") <> "FREE" AND objRSEvent("EventType") <> WORKSHOP AND objRSEvent("EventType") <> LESSON Then						Response.Write("Cover:  ")						Response.Write(objRSEvent("Price"))						Response.Write("<br>")					ElseIf objRSEvent("Price") = "FREE" Then					    Response.Write("<FONT COLOR=#008000>No Cover</FONT><BR>")					ElseIf objRSEvent("EventType") = LESSON or objRSEvent("EventType") = WORKSHOP Then						Response.Write("Price:  ")						Response.Write(objRSEvent("Price"))						Response.Write("<br>")  					End If										If objRSEvent("Age") <> "" AND objRSEvent("Age") <> " " AND objRSEvent("Price") <> "FREE" AND objRSEvent("EventType") <> WORKSHOP AND objRSEvent("EventType") <> LESSON Then						Response.Write("<FONT COLOR=#800000>") 						Response.Write("Age:  ")						Response.Write(objRSEvent("Age"))						Response.Write("</font><br>")					ElseIf objRSEvent("EventType") = LESSON or objRSEvent("EventType") = WORKSHOP Then						Response.Write("Age:  ")						Response.Write(objRSEvent("Age"))						Response.Write("<br>")					End If					%>				   </font>				</td>			</tr>												<% 				objRSEvent.MoveNext				intIsFirst = 1					intNewMonth = 1								If objRSEvent.EOF Then					Exit Do				End If				Loop  ' end do while objRSEvent("date") = datCounterday 							CurrMonth = Month(datCounterDay)			datCounterDay = DateAdd("d",1,datCounterDay)			intIsFirst = 0			If (CurrMonth <> Month(datCounterDay)) Then				intNewMonth = 0			End if		End if			%>		   	</TR>			      	<%					'		Response.write("Do While: datCounterDay  ")	'		Response.write(datCounterDay)	'		Response.write("Do While: datEndDate   ")	'		Response.write(datEndDate)	'		Response.write("<BR>")	'		MnthNmTest = MonthName(Month(datCounterDay))	'		Response.write(MnthNmTest)	'		Response.write("datCounterDay < datEndDate =")	'		Response.write(DateValue(datCounterDay) < DateValue(datEndDate))	'		Response.write("<BR>")						If objRSEvent.EOF Then			Exit do			End If		Loop ' end do While datCounterDay < datEndDate 		%>						</table></center> <!-- end of event line (3 column) table -->		<% objRSEvent.Close %>		</td>	</tr>				</table> <!-- end of global table --><!-- #include file="../include/newbottom.txt" --> 