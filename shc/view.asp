<!-- #include file = "../include/newtop.txt" --><!-- #include file = "../include/geteventset.inc" --><!-- #include file = "../include/hasrights.inc" --><%Dim objDBDim objRSDim SQLDim lngIDDim strTableDim strTableLabellngID = Request.QueryString("ID")strTable = Request.QueryString("table")If IsEmpty (strTable) Then	strTable = "BAND"End IfSelect Case strTableCase "band"	strTableLabel = "Bands"	Case "venue"	strTableLabel = "Venues"	Case "instructor"	strTableLabel = "Instructors"	End Select''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function ListView(table) %><h1 class=type2><%= UCase(strTableLabel) %></h1><table><tr><td align=left>Click on a <% =strTable %> name to see more detailed information</td><td align=right><a href=editrecord.asp?table=<%=strTable%>><small>Add New <%=strTable%></small></a></td></tr></table><table border = 2 cellpadding = 4 cellspacing = 4><tr><td class=weekday>Name</td><td class=weekday>City</td><td class=weekday>State</td></tr><%While Not objRS.EOF%><tr><td><a href = "view.asp?table=<%= strTable %>&id=<% = objRS(strTable & "ID") %>" class = red><%= objRS("NAME") %></a></td><td><%= objRS("city") %></td><td><%= objRS("state") %></td></tr><%objRS.MoveNextWendResponse.Write("</table>")End Function	'ListView() '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Function DetailView(ID) %><% If strTable = "venue" Then %>Click on the Street Address to get a map and driving directions<p><% End If %><table border="3" width="200" align = "right">    <tr>       <td bgcolor = "#FFFFDA" valign="top" align="left"><b><font size = 3>Upcoming        <% Select Case strTable				Case "band"			Response.Write("Gigs for ")					Case "venue"			Response.Write("Events at ")					Case "instructor"			Response.Write("Lessons/Workshops with ")					End Select %>		<% = objRS("name") %><br>        </font></b>        <hr><% Select Case strTableCase "band"	GetEventSet objRS("bandid"),"","",YES,YES,YES,YES,date(),DateAdd("m",3,date()),APPROVED,""Case "venue"	GetEventSet "",objRS("venueid"),"",YES,YES,YES,YES,date(),DateAdd("m",3,date()),APPROVED,""Case "instructor"	GetEventSet "","",objRS("instructorid"),YES,YES,YES,YES,date(),DateAdd("m",3,date()),APPROVED,""	End SelectIf objRSEvent.EOF Then	Response.Write("There are no upcoming events in the database for " & objRS("name") & " in the next two months.")End IfWhile Not objRSEvent.EOF	If strTable = "instructor" Then		If objRSEvent("EventType")=LESSON OR objRSEvent("EventType")=WORKSHOP Then			%>			<a href = "events.asp?style=detail&eventid=<% = objRSEvent("EventID") %>">			<% = objRSEvent("Date") %> - <% =objRSEvent("eventname") %> @ <% = objRSEvent("venuename") %>		<%End If ' objRSEvent("EventType")=LESSON, etc	Else		%>		<a href = "events.asp?style=detail&eventid=<% = objRSEvent("EventID") %>">		<% = WeekDayName(WeekDay(objRSEvent("Date")), False, vbSunday) & ", "& objRSEvent("Date") %> - 		<% If strTable = "venue" Then 			Response.Write(objRSEvent("eventname")) 		Else Response.Write(objRSEvent("venuename")) 		End If 'strTable = "venue"	End If 'strTable = "instructor" 	%></a><p></a><p><%objRSEvent.MoveNextWend%></td>    </tr>	</table>	<h2 class = "red"><%= objRS("name") %></h2>	<% If objRS("phone") <> "" and objRS("phone") <> " " Then %>    <% =objRS("phone") %>    <br>		<% End If %>	<% If objRS("fax") <> "" and objRS("fax") <> " " Then %>    <% = objRS("fax") %> (fax)    <br>	<% End If %>    <% If objRS("url") <> "" and objRS("url") <> " " Then %>    <a href="<% = objRS("url") %>" target=_blank><% = objRS("url") %></a>    <br>	<% End If %>	<% If objRS("email") <> "" and objRS("email") <> " " Then %>    <a href = "mailto:<% = objRS("email") %>"><% = objRS("email") %></a>    <br>	<% End If %>	<% If objRS("address1") <> "" and objRS("address1") <> " " Then %>      <% If strTable = "venue" Then %><a href = "http://maps.yahoo.com/py/maps.py?Pyt=Tmap&addr=<%=objRS("ADDRESS1")%>&csz=<%=objRS("ZIP")%>&Get+Map=Get+Map" target=_blank>	  <% End If %>	  <% = objRS("address1") %>	  <% If strTable = "venue" Then %>	  </a>	  <% End If %>	  <br>	<% End If %>	<% If objRS("address2") <> "" and objRS("address2") <> " " Then %>    <% = objRS("address2") %>    <br>	<% End If %>    <% = objRS("city") %>,<% = objRS("state") %> &nbsp; <% = objRS("zip") %>    <br>	<% 	Dim strTemp2	strTemp2 = objRS("note1")	If (Len(strTemp2) > 2) Then %>		<b>Description:</b><br> <%Response.Write(strTemp2) %>		<br>	<% 	End If %>	<% 	strTemp2 = objRS("note2")	If (Len(strTemp2) > 2) Then %>		<%Response.Write(strTemp2) %>		<br>	<% End If %>	<br clear=all>	<hr>	<table width=100%>	<tr>	<td align=left>	<!-- <small><a href=view.asp?table=<%=strTable%>>Back To <%=strTableLabel%></a></small> -->	<small><a href=<%=Request.servervariables("HTTP_REFERER")%>>Back</a></small>	</td>	<%	If HasRights("editvbi", Session("userlevel")) Then		%>		<td align=center>		<small>		<%		Response.Write("<a href=editrecord.asp?table="&strTable&"&"&strTable&"id="&objRS(strTable&"id")&"&action=edit%20"&strTable&">Edit This "&strTable&"</a>")		%>		</small>		</td>				<%	End If	%>	<td align=right>	<small><a href=editrecord.asp?table=<%=strTable%>>Add New <%=strTable%></a></small></td></tr></table>	  <% End Function 'DetailView() '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Set objDB = Server.CreateObject("ADODB.Connection")Set objRS = Server.CreateObject("ADODB.Recordset")objDB.Open DATABASEIf IsEmpty(lngID) Then	SQL = "SELECT "& strTable &"Table."& strTable &"ID, "& strTable &"Table.Name, " & _		""& strTable &"Table.Approved, "& strTable &"Table.UserID, Address.Address1, Address.Address2, " & _		"Address.City, Address.State, Address.Country, Address.Zip, Address.Phone, " & _		"Address.Fax, Internet.email, Internet.URL, "& strTable &"Table.AddressID, "& strTable &"Table.InternetID, " & _		"Internet.InternetID, Address.AddressID, "& strTable &"Table.CreationDate, " & _		""& strTable &"Table.UpdateDate, "& strTable &"Table.Note1, "& strTable &"Table.Note2 "& _		"FROM Internet RIGHT JOIN (Address RIGHT JOIN "& strTable &" AS "& strTable &"Table ON Address.AddressID = " & _		""& strTable &"Table.AddressID) ON Internet.InternetID = "& strTable &"Table.InternetID " & _		" where "& strTable &"Table.approved = '" & APPROVED & "'" & _		" ORDER BY " & strTable &"Table.Name;"Else	SQL = "SELECT "& strTable &"Table."& strTable &"ID, "& strTable &"Table.Name, " & _		""& strTable &"Table.Approved, "& strTable &"Table.UserID, Address.Address1, Address.Address2, " & _		"Address.City, Address.State, Address.Country, Address.Zip, Address.Phone, " & _		"Address.Fax, Internet.email, Internet.URL, "& strTable &"Table.AddressID, "& strTable &"Table.InternetID, " & _		"Internet.InternetID, Address.AddressID, "& strTable &"Table.CreationDate, " & _		""& strTable &"Table.UpdateDate, "& strTable &"Table.Note1, "& strTable &"Table.Note2 "& _		"FROM Internet RIGHT JOIN (Address RIGHT JOIN "& strTable &" AS "& strTable &"Table ON Address.AddressID = " & _		""& strTable &"Table.AddressID) ON Internet.InternetID = "& strTable &"Table.InternetID " & _		"WHERE " & strTable &"ID = " & lngID & ";"End If			objRS.Open SQL, objDBIf IsEmpty(lngID) Then	ListView(strTable)Else	DetailView(lngID)End IfobjRS.CloseobjDB.Close%><!-- #include file="../include/newbottom.txt" -->