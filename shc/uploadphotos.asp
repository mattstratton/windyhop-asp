<% Option Explicit Server.ScriptTimeout = 100000Response.Expires = 0%><!-- #include file="../include/libcat.inc" --><!-- #include file="../include/libphoto.inc" --><!-- #include file="../include/newtop.txt" --><!-- #include file="../include/hasrights.inc" --><!-- #include file="../include/sendmail.inc" --><%Dim strMode	'Mode of the uploadDim objDBDim objRSDim strBrowserstrBrowser = Request.ServerVariables("HTTP_USER_AGENT")Dim strBodySub SelectPhotos	'Subroutine to pick which photos to upload	Dim strNumberToUpload	If inStr(strBrowser,"MSIE") Then		If Request("number") = "" Then			strNumberToUpload = 3		Else			strNumberToUpload = Request("number")		End If	Else		strNumberToUpload = 10	End If	%>		<!--Your userid is "<%=Session("UserID")%>"<br>-->		<H1>UPLOAD PHOTOS</H1>		After you upload your images, you will be able to edit their names, captions, and categories. Images will not be viewable by anyone other that their owner until they are approved by Windyhop admins.<p>		Please note that images must be in JPEG format - GIF's are <b>not</b> supported.<p>				<% If inStr(strBrowser,"MSIE") Then %>				<form name = "buttons">		Specify the number of pictures you want to upload (1&#150;36):&nbsp;</FONT>		<SELECT NAME="numBtns" SIZE="1" onchange="window.location.href = 'uploadphotos.asp?mode=new&number=' + numBtns.value">			<OPTION VALUE="1">1			<OPTION VALUE="2">2			<OPTION SELECTED VALUE="3">3			<OPTION VALUE="4">4			<OPTION VALUE="5">5			<OPTION VALUE="6">6			<OPTION VALUE="7">7			<OPTION VALUE="8">8			<OPTION VALUE="9">9			<OPTION VALUE="10">10			<OPTION VALUE="11">11			<OPTION VALUE="12">12			<OPTION VALUE="13">13			<OPTION VALUE="14">14			<OPTION VALUE="15">15			<OPTION VALUE="16">16			<OPTION VALUE="17">17			<OPTION VALUE="18">18			<OPTION VALUE="19">19			<OPTION VALUE="20">20			<OPTION VALUE="21">21			<OPTION VALUE="22">22			<OPTION VALUE="23">23			<OPTION VALUE="24">24			<OPTION VALUE="25">25			<OPTION VALUE="26">26			<OPTION VALUE="27">27			<OPTION VALUE="28">28			<OPTION VALUE="29">29			<OPTION VALUE="30">30			<OPTION VALUE="31">31			<OPTION VALUE="32">32			<OPTION VALUE="33">33			<OPTION VALUE="34">34			<OPTION VALUE="35">35			<OPTION VALUE="36">36		</SELECT>	</form>	<%End If%>	<form method = "post" action = "uploadphotos.asp?mode=upload&category=unfiled&userid=<%=Session("UserID")%>" ENCTYPE="multipart/form-data">		<% 		Dim x	'Counter variable		For x = 1 to strNumberToUpload			Response.Write("File to upload: <INPUT TYPE=FILE NAME=FILE" & x & " SIZE=50><BR>")		next		%>		<p>		<input type = "submit" VALUE = "Upload">		<input type = "reset" value = "Reset Form">	</form><%End Sub	'SelectPhotosSub PhotoUpload	'This is the subroutine that actually uploads the images to the server	Dim mySmartUpload	Dim strFileName	Dim intDotPosition	Dim strThumbName	Set mySmartUpload = Server.CreateObject("aspSmartUpload.SmartUpload")	mySmartUpload.Upload	Dim x	'Counter variable	For x = 1 to mySmartUpload.files.count		If Not mySmartUpload.Files.Item(x).IsMissing Then			strFileName = mySmartUpload.Files.Item(x).FileName			intDotPosition = InStrRev(strFileName,".")			strFileName = Mid(strFileName,1,intDotPosition - 1) & "-" & Year(Now) & Month(Now) & Day(Now) & Hour(Now) & Minute(Now) & Second (Now) & "." & Mid(strFileName,intDotPosition + 1)			intDotPosition = InStrRev(strFileName,".")			strThumbName = Mid(strFileName,1,intDotPosition - 1) & "_small." & Mid(strFileName,intDotPosition + 1)			mySmartUpload.files.item(x).saveas (UNAPPROVEDPATH & strFileName) 			CreateThumb strFileName,strThumbName			FixKitty(strFileName)			UpdateData 0,strFileName,strThumbName,strFileName,"","0",Session("UserID"),0			CreateLink 0,GetPhotoID("/images/photos/unapproved/" & strFileName),PHOTOLINK		End If	next	%>		<%	'objDB.Close	' Send notification to admins to approve						strBody = "Hey Guys," & vbcrlf & _							vbcrlf & _							"Someone has just uploaded some photos to the Gallery." & _							vbcrlf & _						 	vbcrlf & _							"Get off your lazy tuchas and approve them." & _							vbcrlf & _							vbcrlf & _							"Love, " & vbcrlf &_							"SwingBot"						SendMail "SwingBot", "swingbot@windyhop.org", "admin@windyhop.org", "New dirty pictures at Windyhop!", strBody 	%>	<script language = "javascript">	<!--	window.location.href = "editphotos.asp?uploaded=y"	//-->	</script>	<%End Sub	'PhotoUploadSub Main()	'Main logic	strMode = Request("mode")'If HasRights("photoadmin", Session("UserLevel")) Then	Select Case strMode		Case "upload"			PhotoUpload		Case Else			If Session("UserID") = "" Then				Response.Write("You must be logged in to upload photos. Don't have a login? Get one <a href = /shc/edituser.asp'>here</a>")			Else				SelectPhotos()			End If	End Select'Else'	Response.Write("Sorry...uploading photos is currently disabled. It will be back soon!")'End IfEnd Sub	'MainMain()%><!-- #include file="../include/newbottom.txt" -->